import{_ as dt}from"./_plugin-vue_export-helper-BwE83l92.js";/* empty css                   *//* empty css                    *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                        *//* empty css                  *//* empty css                         *//* empty css                    *//* empty css               *//* empty css                  *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css               *//* empty css                *//* empty css                     */import{y as ut,r as k,l as D,c as mt,j as xe,U as ft,z as W,B as o,R as t,J as l,n as Se,A as I,O as m,al as Z,u as p,L as Q,P as w,K as Ve,a4 as he,I as Le,E as pt}from"./vendor-BcB6VvZI.js";import{E as f,c as ct,aq as gt,Z as _t,b as vt,ar as yt,y as wt,F as bt,M as xt,as as Ce,u as ne,Y as Te,O as P,at as re,q as ke,d as St,e as Vt,f as ht,a5 as Y,au as Lt,av as Ct,aw as Tt,a9 as ie,ax as kt,aa as Ut,G as Et,ap as Rt,J as $t,H as qt,P as zt,Q as Ft,R as Mt,g as Ue,ay as It,a2 as Bt,az as At,aA as Nt,aB as jt,aC as Dt,h as Wt,W as B}from"./element-CHj0RLGm.js";import{f as de}from"./helpers-iwoUo1o7.js";import{a as L}from"./index-ourEn2z0.js";const Pt={class:"admin-center-page"},Gt={class:"page-header"},Ot={class:"header-content"},Ht={class:"header-actions"},Jt={class:"admin-center-content"},Kt={key:0,class:"admin-section"},Zt={class:"stat-card"},Qt={class:"stat-icon users"},Yt={class:"stat-info"},Xt={class:"stat-value"},el={class:"stat-trend"},tl={class:"stat-card"},ll={class:"stat-icon files"},al={class:"stat-info"},sl={class:"stat-value"},ol={class:"stat-trend"},nl={class:"stat-card"},rl={class:"stat-icon storage"},il={class:"stat-info"},dl={class:"stat-value"},ul={class:"stat-trend"},ml={class:"quick-actions"},fl={key:1,class:"admin-section"},pl={class:"user-filters"},cl={class:"user-actions"},gl={class:"action-left"},_l={class:"user-info"},vl={class:"username-text"},yl={class:"email-text"},wl={class:"storage-info"},bl={class:"storage-text"},xl={class:"time-text"},Sl={key:2,class:"admin-section"},Vl={class:"log-filters"},hl={class:"timestamp-text"},Ll={class:"message-content"},Cl={key:3,class:"admin-section"},Tl=ut({__name:"AdminCenter",setup(kl){const U=k("overview"),x=k(!1),X=k(!1),ee=k(!1),te=k(!1),N=k(!1),ue=k([]),le=k(),R=k(new Set),me=()=>{Se(()=>{document.querySelectorAll(".el-table").forEach(e=>{const i=e,n=i.querySelector(".el-table__body-wrapper");n&&(n.style.width="100%",n.style.marginRight="0px",n.style.paddingRight="0px");const d=i.querySelector(".el-table__header-wrapper");d&&(d.style.width="100%",d.style.marginRight="0px",d.style.paddingRight="0px");const y=i.querySelector(".el-table__inner-wrapper");y&&(y.style.width="100%",y.style.marginRight="0px",y.style.paddingRight="0px")})})},fe=()=>{Se(()=>{document.querySelectorAll(".el-table").forEach(e=>{const i=e,n=i.querySelector(".el-table__header-wrapper"),d=i.querySelector(".el-table__body-wrapper");if(n&&d){const y=i.offsetWidth;n.style.width=`${y}px`,d.style.width=`${y}px`;const F=n.querySelector("table"),z=d.querySelector("table");F&&z&&(F.style.width=`${y}px`,z.style.width=`${y}px`);let u=!1;n.addEventListener("scroll",_=>{u||(u=!0,d.scrollLeft=_.target.scrollLeft,setTimeout(()=>{u=!1},10))}),d.addEventListener("scroll",_=>{u||(u=!0,n.scrollLeft=_.target.scrollLeft,setTimeout(()=>{u=!1},10))});const T=n.querySelector(".el-scrollbar__wrap"),V=d.querySelector(".el-scrollbar__wrap");T&&T.addEventListener("scroll",_=>{u||(u=!0,V&&(V.scrollLeft=_.target.scrollLeft),setTimeout(()=>{u=!1},10))}),V&&V.addEventListener("scroll",_=>{u||(u=!0,T&&(T.scrollLeft=_.target.scrollLeft),setTimeout(()=>{u=!1},10))});const c=i.querySelector(".el-table__fixed-right .el-table__fixed-header-wrapper"),g=i.querySelector(".el-table__fixed-right .el-table__fixed-body-wrapper");c&&c.addEventListener("scroll",()=>{if(u)return;u=!0;const _=c.scrollLeft;n.scrollLeft=_,d.scrollLeft=_,g&&(g.scrollLeft=_),requestAnimationFrame(()=>{u=!1})}),g&&g.addEventListener("scroll",()=>{if(u)return;u=!0;const _=g.scrollLeft;n.scrollLeft=_,d.scrollLeft=_,c&&(c.scrollLeft=_),requestAnimationFrame(()=>{u=!1})}),new MutationObserver(()=>{const _=i.querySelector(".el-table__fixed-right");if(_){const v=_.querySelector(".el-table__fixed-header-wrapper"),q=_.querySelector(".el-table__fixed-body-wrapper");v&&!v.hasAttribute("data-sync-attached")&&(v.setAttribute("data-sync-attached","true"),v.addEventListener("scroll",()=>{if(u)return;u=!0;const h=v.scrollLeft;n.scrollLeft=h,d.scrollLeft=h,q&&(q.scrollLeft=h),requestAnimationFrame(()=>{u=!1})})),q&&!q.hasAttribute("data-sync-attached")&&(q.setAttribute("data-sync-attached","true"),q.addEventListener("scroll",()=>{if(u)return;u=!0;const h=q.scrollLeft;n.scrollLeft=h,d.scrollLeft=h,v&&(v.scrollLeft=h),requestAnimationFrame(()=>{u=!1})}))}}).observe(i,{childList:!0,subtree:!0})}})})},A=D({totalUsers:0,totalFiles:0,totalStorage:0}),$=k([]),G=k([]),C=D({level:"",keyword:""}),b=D({search:"",role:"",status:""}),r=D({systemName:"图库系统",allowRegistration:!0,maintenanceMode:!1,maxFileSize:100,maxUploadFiles:10,allowedImageTypes:["jpg","png","gif","webp"],allowedVideoTypes:["mp4","webm","mov"],thumbnailSize:300,autoCleanLogs:!1}),S=D({username:"",email:"",password:"",role:"user"}),Ee={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度必须在2-20个字符之间",trigger:"blur"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9_\s]+$/,message:"用户名只能包含中文、字母、数字、下划线和空格",trigger:"blur"},{validator:(a,e,i)=>{e&&e.includes("@")?i(new Error("用户名不能使用邮箱格式")):e&&e.trim().length===0?i(new Error("用户名不能只包含空格")):i()},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]},Re=mt(()=>{let a=G.value;if(C.level&&(a=a.filter(e=>e.level===C.level)),C.keyword){const e=C.keyword.toLowerCase();a=a.filter(i=>i.message.toLowerCase().includes(e)||i.source.toLowerCase().includes(e))}return a});let O=null;const $e=a=>{U.value=a},H=async()=>{if(x.value){f.warning("正在刷新中，请稍候...");return}x.value=!0;try{await qe(),await ae(),await Me(),await pe(),f.success("数据刷新成功")}catch{f.error("刷新数据失败")}finally{x.value=!1}},qe=async()=>{try{const e=(await L.get("/admin/stats")).data;A.totalUsers=e.total_users||0,A.totalFiles=e.total_files||0,A.totalStorage=e.total_file_size||0}catch(a){throw a}},ze=a=>{switch(a){case"active":return"success";case"inactive":return"danger";case"suspended":return"warning";default:return"info"}},Fe=a=>{switch(a){case"active":return"正常";case"inactive":return"已禁用";case"suspended":return"已暂停";default:return"未知"}},ae=async()=>{try{const a=await L.get("/admin/users");$.value=a.data.users||[],me(),fe()}catch(a){throw a}},Me=async()=>{try{const a=await L.get("/admin/logs");G.value=a.data.logs||[]}catch(a){throw a}},pe=async()=>{var a,e,i,n,d,y,F,z,u,T,V;ee.value=!0;try{const g=(await L.get("/admin/settings")).data.settings||{};r.systemName=((a=g.system_name)==null?void 0:a.value)||"图库系统",r.allowRegistration=((e=g.enable_registration)==null?void 0:e.value)==="true",r.maintenanceMode=((i=g.maintenance_mode)==null?void 0:i.value)==="true",r.maxFileSize=parseInt((n=g.max_file_size)==null?void 0:n.value)||100,r.maxUploadFiles=parseInt((d=g.max_upload_files)==null?void 0:d.value)||10,r.allowedImageTypes=((F=(y=g.allowed_image_types)==null?void 0:y.value)==null?void 0:F.split(","))||["jpg","png","gif","webp"],r.allowedVideoTypes=((u=(z=g.allowed_video_types)==null?void 0:z.value)==null?void 0:u.split(","))||["mp4","webm","mov"],r.thumbnailSize=parseInt((T=g.thumbnail_size)==null?void 0:T.value)||300,r.autoCleanLogs=((V=g.auto_clean_logs)==null?void 0:V.value)==="true"}catch(c){throw f.error("获取系统设置失败"),c}finally{ee.value=!1}},Ie=a=>{ue.value=a},Be=a=>{const e=a.id;R.value.has(e)?R.value.delete(e):(R.value.clear(),R.value.add(e))},Ae=a=>R.value.has(a.id),Ne=(a,e)=>{const i=e.id;a?(R.value.clear(),R.value.add(i)):R.value.delete(i)},ce=()=>{R.value.clear()};xe(()=>{document.addEventListener("click",a=>{const e=a.target;!e.closest(".el-dropdown")&&!e.closest(".el-dropdown-menu")&&ce()})});const je=async(a,e)=>{ce();try{switch(a){case"toggleRole":const n=(e.role==="admin"?"user":"admin")==="admin"?"管理员":"普通用户";await B.confirm(`确定要将用户 "${e.username}" 设置为${n}吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"custom-message-box"}),await De(e);break;case"toggleStatus":const y=(e.status==="active"?"inactive":"active")==="active"?"启用":"禁用";await B.confirm(`确定要${y}用户 "${e.username}" 吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"custom-message-box"}),await We(e);break;case"manageStorage":f.info({message:"存储管理功能开发中...",duration:2e3,showClose:!0});break;case"delete":await B.confirm(`确定要删除用户 "${e.username}" 吗？此操作不可恢复！`,"危险操作",{confirmButtonText:"删除",cancelButtonText:"取消",type:"error",customClass:"custom-message-box custom-danger-box",confirmButtonClass:"el-button--danger"}),await Pe(e),f.success("用户已删除");break}}catch(i){i==="cancel"?f.info("操作已取消"):f.error("操作失败，请重试")}},De=async a=>{try{const e=a.role==="admin"?"user":"admin";await L.put(`/admin/users/${a.id}/role`,{role:e});const i=$.value.findIndex(n=>n.id===a.id);i!==-1&&($.value[i].role=e),f.success(`用户角色已更新为${e==="admin"?"管理员":"普通用户"}`)}catch(e){throw f.error("切换用户角色失败"),e}},We=async a=>{try{const e=a.status==="active"?"inactive":"active";await L.put(`/admin/users/${a.id}/status`,{status:e});const i=$.value.findIndex(n=>n.id===a.id);i!==-1&&($.value[i].status=e),f.success(`用户状态已更新为${e==="active"?"正常":"已禁用"}`)}catch(e){throw f.error("切换用户状态失败"),e}},Pe=async a=>{try{await B.confirm(`确定要删除用户 "${a.username}" 吗？

此操作将删除：
- 用户的所有文件
- 用户的所有文件夹
- 用户的登录记录
- 相关的系统日志

此操作不可撤销！`,"删除用户确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}),await L.delete(`/admin/users/${a.id}`),$.value=$.value.filter(e=>e.id!==a.id),f.success(`用户 "${a.username}" 已删除`)}catch(e){e!=="cancel"&&f.error("删除用户失败")}},Ge=()=>{f.info("批量删除功能开发中...")},ge=async()=>{if(x.value){f.warning("正在刷新中，请稍候...");return}try{const a={};b.search&&(a.search=b.search),b.role&&(a.role=b.role),b.status&&(a.status=b.status);const e=await L.get("/admin/users",{params:a});$.value=e.data.users||[],f.success("搜索完成")}catch{f.error("搜索用户失败")}},Oe=async()=>{if(x.value){f.warning("正在刷新中，请稍候...");return}b.search="",b.role="",b.status="";try{await ae(),f.success("筛选已重置")}catch{f.error("重置筛选失败")}},He=async()=>{if(le.value)try{await le.value.validate(),te.value=!0,await L.post("/admin/users",{username:S.username,email:S.email,password:S.password,role:S.role}),f.success("用户创建成功"),N.value=!1,Object.assign(S,{username:"",email:"",password:"",role:"user"}),await ae()}catch{f.error("创建用户失败")}finally{te.value=!1}},_e=async()=>{if(x.value){f.warning("正在刷新中，请稍候...");return}try{const a={};C.level&&(a.level=C.level);const e=await L.get("/admin/logs",{params:a});G.value=e.data.logs||[],f.success("日志搜索完成")}catch{f.error("搜索日志失败")}},Je=async()=>{if(x.value){f.warning("正在刷新中，请稍候...");return}try{await B.confirm("确定要清空所有日志吗？","清空确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await L.delete("/admin/logs"),G.value=[],f.success("日志已清空")}catch(a){a!=="cancel"&&f.error("清空日志失败")}},Ke=async()=>{if(r.allowedImageTypes.length===0){f.error("至少需要选择一种图片格式");return}if(r.systemName.trim().length===0){f.error("系统名称不能为空");return}X.value=!0;try{const a={system_name:r.systemName.trim(),enable_registration:r.allowRegistration.toString(),maintenance_mode:r.maintenanceMode.toString(),max_file_size:r.maxFileSize.toString(),max_upload_files:r.maxUploadFiles.toString(),allowed_image_types:r.allowedImageTypes.join(","),allowed_video_types:r.allowedVideoTypes.join(","),thumbnail_size:r.thumbnailSize.toString(),auto_clean_logs:r.autoCleanLogs.toString()};await L.put("/admin/settings",{settings:a}),f.success("系统设置保存成功"),r.maintenanceMode&&B.alert("维护模式已开启，普通用户将无法访问系统。请确保在维护完成后及时关闭维护模式。","维护模式提醒",{confirmButtonText:"我知道了",type:"warning"})}catch{f.error("保存设置失败")}finally{X.value=!1}},Ze=()=>{B.alert(`
    <div style="text-align: left;">
      <h4>当前设置预览：</h4>
      <p><strong>系统名称：</strong>${r.systemName}</p>
      <p><strong>允许注册：</strong>${r.allowRegistration?"是":"否"}</p>
      <p><strong>维护模式：</strong>${r.maintenanceMode?"开启":"关闭"}</p>
      <p><strong>最大文件大小：</strong>${r.maxFileSize}MB</p>
      <p><strong>单次上传数量：</strong>${r.maxUploadFiles}个</p>
      <p><strong>允许的图片类型：</strong>${r.allowedImageTypes.join(", ")}</p>
      <p><strong>允许的视频类型：</strong>${r.allowedVideoTypes.join(", ")}</p>
      <p><strong>缩略图尺寸：</strong>${r.thumbnailSize}px</p>
      <p><strong>自动清理日志：</strong>${r.autoCleanLogs?"开启":"关闭"}</p>
    </div>
    `,"设置预览",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0})},Qe=a=>{switch(a){case"error":return"danger";case"warning":return"warning";case"info":return"success";default:return"info"}},Ye=a=>{switch(a){case"error":return"错误";case"warning":return"警告";case"info":return"信息";default:return"未知"}},ve=a=>{if(!a)return"未知时间";try{return new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return a}},Xe=(a,e)=>{if(!e||e===0)return"#e6e6e6";const i=a/e*100;return i>=90?"#f56c6c":i>=70?"#e6a23c":"#67c23a"},et=()=>{O=setInterval(()=>{x.value||H()},6e4)},tt=()=>{O&&(clearInterval(O),O=null)};return xe(async()=>{try{await H(),et(),me(),fe()}catch{f.error("初始化数据失败")}}),ft(()=>{tt()}),(a,e)=>{const i=Z("Refresh"),n=vt,d=ct,y=xt,F=bt,z=wt,u=yt,T=gt,V=ht,c=Vt,g=Ct,j=Lt,_=St,v=Ut,q=Et,h=Rt,lt=$t,J=Mt,at=Ft,st=qt,ye=Bt,K=At,se=Nt,ot=Z("Upload"),oe=jt,E=Wt,we=Dt,nt=Z("Tools"),rt=Z("View"),it=_t,be=kt;return I(),W("div",Pt,[o("div",Gt,[o("div",Ot,[e[26]||(e[26]=o("div",{class:"header-left"},[o("h1",{class:"page-title"},"管理中心"),o("p",{class:"page-subtitle"},"系统管理、监控和日志中心")],-1)),o("div",Ht,[t(d,{onClick:H,loading:x.value},{default:l(()=>[t(n,null,{default:l(()=>[t(i)]),_:1}),e[25]||(e[25]=m(" 刷新数据 ",-1))]),_:1},8,["loading"])])])]),o("div",Jt,[t(T,{gutter:24},{default:l(()=>[t(u,{xs:24,sm:8,md:6,lg:5,xl:4},{default:l(()=>[t(z,{class:"admin-nav-card"},{default:l(()=>[t(F,{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=s=>U.value=s),class:"admin-menu",onSelect:$e},{default:l(()=>[t(y,{index:"overview"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Ce))]),_:1}),e[27]||(e[27]=o("span",null,"系统概览",-1))]),_:1}),t(y,{index:"users"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(ne))]),_:1}),e[28]||(e[28]=o("span",null,"用户管理",-1))]),_:1}),t(y,{index:"logs"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Te))]),_:1}),e[29]||(e[29]=o("span",null,"系统日志",-1))]),_:1}),t(y,{index:"settings"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(P))]),_:1}),e[30]||(e[30]=o("span",null,"系统设置",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(u,{xs:24,sm:16,md:18,lg:19,xl:20},{default:l(()=>[t(z,{class:"admin-panel-card"},{default:l(()=>[U.value==="overview"?(I(),W("div",Kt,[e[42]||(e[42]=o("div",{class:"section-header"},[o("h3",null,"系统概览"),o("p",null,"系统整体运行状态和统计数据")],-1)),t(T,{gutter:16,class:"stats-cards"},{default:l(()=>[t(u,{xs:12,sm:8,md:8,lg:8,xl:8},{default:l(()=>[o("div",Zt,[o("div",Qt,[t(n,null,{default:l(()=>[t(p(ne))]),_:1})]),o("div",Yt,[o("div",Xt,w(A.totalUsers),1),e[32]||(e[32]=o("div",{class:"stat-label"},"总用户数",-1)),o("div",el,[t(n,{class:"trend-icon"},{default:l(()=>[t(p(re))]),_:1}),e[31]||(e[31]=o("span",{class:"trend-text"},"活跃用户",-1))])])])]),_:1}),t(u,{xs:12,sm:8,md:8,lg:8,xl:8},{default:l(()=>[o("div",tl,[o("div",ll,[t(n,null,{default:l(()=>[t(p(ke))]),_:1})]),o("div",al,[o("div",sl,w(A.totalFiles),1),e[34]||(e[34]=o("div",{class:"stat-label"},"总文件数",-1)),o("div",ol,[t(n,{class:"trend-icon"},{default:l(()=>[t(p(re))]),_:1}),e[33]||(e[33]=o("span",{class:"trend-text"},"存储文件",-1))])])])]),_:1}),t(u,{xs:24,sm:8,md:8,lg:8,xl:8},{default:l(()=>[o("div",nl,[o("div",rl,[t(n,null,{default:l(()=>[t(p(Ce))]),_:1})]),o("div",il,[o("div",dl,w(p(de)(A.totalStorage)),1),e[36]||(e[36]=o("div",{class:"stat-label"},"总存储量",-1)),o("div",ul,[t(n,{class:"trend-icon"},{default:l(()=>[t(p(re))]),_:1}),e[35]||(e[35]=o("span",{class:"trend-text"},"已使用",-1))])])])]),_:1})]),_:1}),o("div",ml,[e[41]||(e[41]=o("h4",null,"快速操作",-1)),t(T,{gutter:12},{default:l(()=>[t(u,{xs:12,sm:6,md:6,lg:6,xl:6},{default:l(()=>[t(d,{class:"quick-action-btn",onClick:e[1]||(e[1]=s=>U.value="users")},{default:l(()=>[t(n,null,{default:l(()=>[t(p(ne))]),_:1}),e[37]||(e[37]=o("span",null,"用户管理",-1))]),_:1})]),_:1}),t(u,{xs:12,sm:6,md:6,lg:6,xl:6},{default:l(()=>[t(d,{class:"quick-action-btn",onClick:e[2]||(e[2]=s=>U.value="logs")},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Te))]),_:1}),e[38]||(e[38]=o("span",null,"系统日志",-1))]),_:1})]),_:1}),t(u,{xs:12,sm:6,md:6,lg:6,xl:6},{default:l(()=>[t(d,{class:"quick-action-btn",onClick:e[3]||(e[3]=s=>U.value="settings")},{default:l(()=>[t(n,null,{default:l(()=>[t(p(P))]),_:1}),e[39]||(e[39]=o("span",null,"系统设置",-1))]),_:1})]),_:1}),t(u,{xs:12,sm:6,md:6,lg:6,xl:6},{default:l(()=>[t(d,{class:"quick-action-btn",onClick:H},{default:l(()=>[t(n,null,{default:l(()=>[t(i)]),_:1}),e[40]||(e[40]=o("span",null,"刷新数据",-1))]),_:1})]),_:1})]),_:1})])])):Q("",!0),U.value==="users"?(I(),W("div",fl,[e[49]||(e[49]=o("div",{class:"section-header"},[o("h3",null,"用户管理"),o("p",null,"管理系统用户和权限")],-1)),o("div",pl,[t(_,{model:b,inline:""},{default:l(()=>[t(c,{label:"搜索用户"},{default:l(()=>[t(V,{modelValue:b.search,"onUpdate:modelValue":e[4]||(e[4]=s=>b.search=s),placeholder:"用户名或邮箱",clearable:"",style:{width:"200px"},onKeyup:he(ge,["enter"])},{prefix:l(()=>[t(n,null,{default:l(()=>[t(p(Y))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"角色"},{default:l(()=>[t(j,{modelValue:b.role,"onUpdate:modelValue":e[5]||(e[5]=s=>b.role=s),placeholder:"选择角色",clearable:"",style:{width:"120px"}},{default:l(()=>[t(g,{label:"全部",value:""}),t(g,{label:"管理员",value:"admin"}),t(g,{label:"用户",value:"user"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"状态"},{default:l(()=>[t(j,{modelValue:b.status,"onUpdate:modelValue":e[6]||(e[6]=s=>b.status=s),placeholder:"选择状态",clearable:"",style:{width:"120px"}},{default:l(()=>[t(g,{label:"全部",value:""}),t(g,{label:"正常",value:"active"}),t(g,{label:"已禁用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:l(()=>[t(d,{type:"primary",onClick:ge,loading:x.value},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Y))]),_:1}),e[43]||(e[43]=m(" 搜索 ",-1))]),_:1},8,["loading"]),t(d,{onClick:Oe},{default:l(()=>[t(n,null,{default:l(()=>[t(i)]),_:1}),e[44]||(e[44]=m(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),o("div",cl,[o("div",gl,[t(d,{type:"primary",onClick:e[7]||(e[7]=s=>N.value=!0)},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Tt))]),_:1}),e[45]||(e[45]=m(" 创建用户 ",-1))]),_:1}),t(d,{onClick:Ge,disabled:ue.value.length===0},{default:l(()=>[t(n,null,{default:l(()=>[t(p(ie))]),_:1}),e[46]||(e[46]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])])]),Ve((I(),Le(ye,{data:$.value,style:{width:"100%","table-layout":"fixed"},onSelectionChange:Ie,"empty-text":"暂无用户数据","row-key":s=>s.id},{default:l(()=>[t(v,{type:"selection",width:"55"}),t(v,{prop:"username",label:"用户名",width:"140"},{default:l(({row:s})=>[o("div",_l,[t(q,{size:32,src:s.avatar_url},{default:l(()=>{var M;return[m(w((M=s.username)==null?void 0:M.charAt(0).toUpperCase()),1)]}),_:2},1032,["src"]),o("span",vl,w(s.username||"未知用户"),1)])]),_:1}),t(v,{prop:"email",label:"邮箱","min-width":"120"},{default:l(({row:s})=>[o("span",yl,w(s.email||"未设置"),1)]),_:1}),t(v,{prop:"role",label:"角色",width:"60"},{default:l(({row:s})=>[t(h,{type:s.role==="admin"?"danger":"primary",size:"small"},{default:l(()=>[m(w(s.role==="admin"?"管理员":"用户"),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"status",label:"状态",width:"80"},{default:l(({row:s})=>[t(h,{type:ze(s.status),size:"small"},{default:l(()=>[m(w(Fe(s.status)),1)]),_:2},1032,["type"])]),_:1}),t(v,{label:"存储使用",width:"120"},{default:l(({row:s})=>[o("div",wl,[t(lt,{percentage:Math.round((s.used_storage||0)/(s.storage_limit||1)*100),"stroke-width":6,"show-text":!1,color:Xe(s.used_storage,s.storage_limit)},null,8,["percentage","color"]),o("span",bl,w(p(de)(s.used_storage||0))+" / "+w(p(de)(s.storage_limit||0)),1)])]),_:1}),t(v,{prop:"created_at",label:"注册时间",width:"100"},{default:l(({row:s})=>[o("span",xl,w(ve(s.created_at)),1)]),_:1}),t(v,{label:"操作",width:"60",fixed:"right"},{default:l(({row:s})=>[t(st,{onCommand:M=>je(M,s),onVisibleChange:M=>Ne(M,s),trigger:"click","hide-on-click":!0},{dropdown:l(()=>[t(at,null,{default:l(()=>[t(J,{command:"toggleRole"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Ue))]),_:1}),m(" "+w(s.role==="admin"?"取消管理员":"设为管理员"),1)]),_:2},1024),t(J,{command:"toggleStatus"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(It))]),_:1}),m(" "+w(s.status==="active"?"禁用用户":"启用用户"),1)]),_:2},1024),t(J,{command:"manageStorage"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(ke))]),_:1}),e[47]||(e[47]=m(" 管理存储 ",-1))]),_:1}),t(J,{command:"delete",divided:""},{default:l(()=>[t(n,null,{default:l(()=>[t(p(ie))]),_:1}),e[48]||(e[48]=m(" 删除用户 ",-1))]),_:1})]),_:2},1024)]),default:l(()=>[t(d,{type:"text",size:"small",onClick:M=>Be(s),class:pt({"menu-open":Ae(s)})},{default:l(()=>[t(n,null,{default:l(()=>[t(p(zt))]),_:1})]),_:1},8,["onClick","class"])]),_:2},1032,["onCommand","onVisibleChange"])]),_:1})]),_:1},8,["data","row-key"])),[[be,x.value]])])):Q("",!0),U.value==="logs"?(I(),W("div",Sl,[e[52]||(e[52]=o("div",{class:"section-header"},[o("h3",null,"系统日志"),o("p",null,"查看和管理系统运行日志")],-1)),o("div",Vl,[t(_,{model:C,inline:""},{default:l(()=>[t(c,{label:"日志级别"},{default:l(()=>[t(j,{modelValue:C.level,"onUpdate:modelValue":e[8]||(e[8]=s=>C.level=s),placeholder:"选择级别",clearable:"",style:{width:"120px"}},{default:l(()=>[t(g,{label:"全部",value:""}),t(g,{label:"错误",value:"error"}),t(g,{label:"警告",value:"warning"}),t(g,{label:"信息",value:"info"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"关键词"},{default:l(()=>[t(V,{modelValue:C.keyword,"onUpdate:modelValue":e[9]||(e[9]=s=>C.keyword=s),placeholder:"搜索日志内容",clearable:"",style:{width:"200px"},onKeyup:he(_e,["enter"])},{prefix:l(()=>[t(n,null,{default:l(()=>[t(p(Y))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:l(()=>[t(d,{type:"primary",onClick:_e,loading:x.value},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Y))]),_:1}),e[50]||(e[50]=m(" 搜索 ",-1))]),_:1},8,["loading"]),t(d,{onClick:Je,loading:x.value},{default:l(()=>[t(n,null,{default:l(()=>[t(p(ie))]),_:1}),e[51]||(e[51]=m(" 清空日志 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),Ve((I(),Le(ye,{data:Re.value,style:{width:"100%"},height:"400","empty-text":"暂无日志数据"},{default:l(()=>[t(v,{prop:"timestamp",label:"时间",width:"180"},{default:l(({row:s})=>[o("span",hl,w(ve(s.timestamp)),1)]),_:1}),t(v,{prop:"level",label:"级别",width:"100"},{default:l(({row:s})=>[t(h,{type:Qe(s.level),size:"small"},{default:l(()=>[m(w(Ye(s.level)),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"source",label:"来源",width:"120"},{default:l(({row:s})=>[t(h,{size:"small",type:"info"},{default:l(()=>[m(w(s.source||"系统"),1)]),_:2},1024)]),_:1}),t(v,{prop:"message",label:"消息","min-width":"200"},{default:l(({row:s})=>[o("div",Ll,w(s.message||"无消息内容"),1)]),_:1})]),_:1},8,["data"])),[[be,x.value]])])):Q("",!0),U.value==="settings"?(I(),W("div",Cl,[e[82]||(e[82]=o("div",{class:"section-header"},[o("h3",null,"系统设置"),o("p",null,"配置系统参数和功能")],-1)),t(_,{"label-width":"120px",class:"system-settings-form"},{default:l(()=>[t(K,{"content-position":"left"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(P))]),_:1}),e[53]||(e[53]=m(" 基本设置 ",-1))]),_:1}),t(c,{label:"系统名称"},{default:l(()=>[t(V,{modelValue:r.systemName,"onUpdate:modelValue":e[10]||(e[10]=s=>r.systemName=s),placeholder:"请输入系统名称",clearable:"",maxlength:"50","show-word-limit":""},{prefix:l(()=>[t(n,null,{default:l(()=>[t(p(P))]),_:1})]),_:1},8,["modelValue"]),e[54]||(e[54]=o("div",{class:"form-description"},"显示在页面标题和登录页面的系统名称",-1))]),_:1}),t(K,{"content-position":"left"},{default:l(()=>[t(n,null,{default:l(()=>[t(p(Ue))]),_:1}),e[55]||(e[55]=m(" 用户管理 ",-1))]),_:1}),t(c,{label:"允许注册"},{default:l(()=>[t(se,{modelValue:r.allowRegistration,"onUpdate:modelValue":e[11]||(e[11]=s=>r.allowRegistration=s),"active-text":"允许","inactive-text":"禁止","active-color":"#13ce66","inactive-color":"#ff4949"},null,8,["modelValue"]),e[56]||(e[56]=o("div",{class:"form-description"},"是否允许新用户注册，关闭后只能由管理员创建用户",-1))]),_:1}),t(c,{label:"维护模式"},{default:l(()=>[t(se,{modelValue:r.maintenanceMode,"onUpdate:modelValue":e[12]||(e[12]=s=>r.maintenanceMode=s),"active-text":"开启","inactive-text":"关闭","active-color":"#ff4949","inactive-color":"#13ce66"},null,8,["modelValue"]),e[57]||(e[57]=o("div",{class:"form-description"},"开启后只有管理员可以访问系统，普通用户将看到维护页面",-1))]),_:1}),t(K,{"content-position":"left"},{default:l(()=>[t(n,null,{default:l(()=>[t(ot)]),_:1}),e[58]||(e[58]=m(" 文件上传 ",-1))]),_:1}),t(c,{label:"最大文件大小"},{default:l(()=>[t(oe,{modelValue:r.maxFileSize,"onUpdate:modelValue":e[13]||(e[13]=s=>r.maxFileSize=s),min:1,max:1e3,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[59]||(e[59]=o("span",{class:"form-unit"},"MB",-1)),e[60]||(e[60]=o("div",{class:"form-description"},"单个文件上传的最大大小限制，建议不超过100MB",-1))]),_:1}),t(c,{label:"单次上传数量"},{default:l(()=>[t(oe,{modelValue:r.maxUploadFiles,"onUpdate:modelValue":e[14]||(e[14]=s=>r.maxUploadFiles=s),min:1,max:50,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[61]||(e[61]=o("span",{class:"form-unit"},"个",-1)),e[62]||(e[62]=o("div",{class:"form-description"},"单次最多可以上传的文件数量",-1))]),_:1}),t(c,{label:"允许的图片类型"},{default:l(()=>[t(we,{modelValue:r.allowedImageTypes,"onUpdate:modelValue":e[15]||(e[15]=s=>r.allowedImageTypes=s)},{default:l(()=>[t(E,{label:"jpg"},{default:l(()=>[...e[63]||(e[63]=[m("JPG",-1)])]),_:1}),t(E,{label:"jpeg"},{default:l(()=>[...e[64]||(e[64]=[m("JPEG",-1)])]),_:1}),t(E,{label:"png"},{default:l(()=>[...e[65]||(e[65]=[m("PNG",-1)])]),_:1}),t(E,{label:"gif"},{default:l(()=>[...e[66]||(e[66]=[m("GIF",-1)])]),_:1}),t(E,{label:"webp"},{default:l(()=>[...e[67]||(e[67]=[m("WebP",-1)])]),_:1}),t(E,{label:"svg"},{default:l(()=>[...e[68]||(e[68]=[m("SVG",-1)])]),_:1})]),_:1},8,["modelValue"]),e[69]||(e[69]=o("div",{class:"form-description"},"选择允许上传的图片格式，至少选择一种格式",-1))]),_:1}),t(c,{label:"允许的视频类型"},{default:l(()=>[t(we,{modelValue:r.allowedVideoTypes,"onUpdate:modelValue":e[16]||(e[16]=s=>r.allowedVideoTypes=s)},{default:l(()=>[t(E,{label:"mp4"},{default:l(()=>[...e[70]||(e[70]=[m("MP4",-1)])]),_:1}),t(E,{label:"webm"},{default:l(()=>[...e[71]||(e[71]=[m("WebM",-1)])]),_:1}),t(E,{label:"mov"},{default:l(()=>[...e[72]||(e[72]=[m("MOV",-1)])]),_:1}),t(E,{label:"avi"},{default:l(()=>[...e[73]||(e[73]=[m("AVI",-1)])]),_:1})]),_:1},8,["modelValue"]),e[74]||(e[74]=o("div",{class:"form-description"},"选择允许上传的视频格式",-1))]),_:1}),t(K,{"content-position":"left"},{default:l(()=>[t(n,null,{default:l(()=>[t(nt)]),_:1}),e[75]||(e[75]=m(" 系统优化 ",-1))]),_:1}),t(c,{label:"缩略图尺寸"},{default:l(()=>[t(oe,{modelValue:r.thumbnailSize,"onUpdate:modelValue":e[17]||(e[17]=s=>r.thumbnailSize=s),min:100,max:800,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[76]||(e[76]=o("span",{class:"form-unit"},"px",-1)),e[77]||(e[77]=o("div",{class:"form-description"},"生成缩略图的尺寸，影响加载速度和存储空间",-1))]),_:1}),t(c,{label:"自动清理日志"},{default:l(()=>[t(se,{modelValue:r.autoCleanLogs,"onUpdate:modelValue":e[18]||(e[18]=s=>r.autoCleanLogs=s),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"]),e[78]||(e[78]=o("div",{class:"form-description"},"自动清理30天前的系统日志",-1))]),_:1}),t(c,null,{default:l(()=>[t(d,{type:"primary",onClick:Ke,loading:X.value},{default:l(()=>[t(n,null,{default:l(()=>[t(p(P))]),_:1}),e[79]||(e[79]=m(" 保存设置 ",-1))]),_:1},8,["loading"]),t(d,{onClick:pe,loading:ee.value},{default:l(()=>[t(n,null,{default:l(()=>[t(i)]),_:1}),e[80]||(e[80]=m(" 重置 ",-1))]),_:1},8,["loading"]),t(d,{type:"warning",onClick:Ze},{default:l(()=>[t(n,null,{default:l(()=>[t(rt)]),_:1}),e[81]||(e[81]=m(" 预览效果 ",-1))]),_:1})]),_:1})]),_:1})])):Q("",!0)]),_:1})]),_:1})]),_:1})]),t(it,{modelValue:N.value,"onUpdate:modelValue":e[24]||(e[24]=s=>N.value=s),title:"创建用户",width:"500px"},{footer:l(()=>[t(d,{onClick:e[23]||(e[23]=s=>N.value=!1)},{default:l(()=>[...e[83]||(e[83]=[m("取消",-1)])]),_:1}),t(d,{type:"primary",onClick:He,loading:te.value},{default:l(()=>[...e[84]||(e[84]=[m("创建",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(_,{model:S,rules:Ee,ref_key:"userFormRef",ref:le,"label-width":"100px"},{default:l(()=>[t(c,{label:"用户名",prop:"username"},{default:l(()=>[t(V,{modelValue:S.username,"onUpdate:modelValue":e[19]||(e[19]=s=>S.username=s),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),t(c,{label:"邮箱",prop:"email"},{default:l(()=>[t(V,{modelValue:S.email,"onUpdate:modelValue":e[20]||(e[20]=s=>S.email=s),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),t(c,{label:"密码",prop:"password"},{default:l(()=>[t(V,{modelValue:S.password,"onUpdate:modelValue":e[21]||(e[21]=s=>S.password=s),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(c,{label:"角色",prop:"role"},{default:l(()=>[t(j,{modelValue:S.role,"onUpdate:modelValue":e[22]||(e[22]=s=>S.role=s),placeholder:"选择角色"},{default:l(()=>[t(g,{label:"普通用户",value:"user"}),t(g,{label:"管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Zl=dt(Tl,[["__scopeId","data-v-ed335286"]]);export{Zl as default};
