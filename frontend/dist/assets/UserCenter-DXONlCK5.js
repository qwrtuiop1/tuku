import{_ as Ge}from"./_plugin-vue_export-helper-BwE83l92.js";/* empty css                    *//* empty css                  *//* empty css                   *//* empty css                       *//* empty css               *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 *//* empty css                    *//* empty css                *//* empty css               *//* empty css                  *//* empty css                  */import{E as l,c as He,aq as Ke,Z as Qe,b as Xe,w as Ye,ar as et,y as tt,G as st,aD as at,aE as ot,ap as lt,C as rt,J as it,a9 as nt,aA as dt,aF as ut,aG as ct,d as ft,e as mt,f as pt,aH as gt,aI as vt,aJ as _t,x as yt,aK as wt,aC as bt,h as ht,W as St}from"./element-CHj0RLGm.js";import{u as Vt,a as S}from"./index-DirPTg0b.js";import{b as Ct,f as N}from"./helpers-iwoUo1o7.js";import{y as kt,r as _,l as I,w as ye,c as W,j as Nt,U as Ut,z,B as t,R as s,J as o,A as E,O as m,u as g,P as c,L as we}from"./vendor-BcB6VvZI.js";const Pt={class:"user-center-page"},zt={class:"page-header"},Et={class:"header-content"},xt={class:"header-actions"},At={class:"user-center-content"},It={class:"user-avatar-section"},Rt={class:"avatar-container"},Ft={class:"avatar-overlay"},Ot={class:"user-basic-info"},qt={class:"username"},Dt={class:"user-role"},Wt={class:"user-email"},Jt={class:"storage-header"},Tt={class:"storage-progress"},Bt={class:"storage-info"},$t={class:"used"},jt={class:"total"},Mt={class:"storage-details"},Lt={class:"storage-item"},Zt={class:"value"},Gt={class:"storage-item"},Ht={class:"value"},Kt={class:"storage-item"},Qt={class:"value"},Xt={class:"storage-actions"},Yt={class:"action-button-wrapper"},es={class:"action-button-wrapper"},ts={class:"quick-settings"},ss={class:"setting-item"},as={class:"setting-control"},os={key:0,class:"setting-status"},ls={class:"setting-item"},rs={class:"setting-control"},is={key:0,class:"setting-status"},ns={key:1,class:"setting-status"},ds={key:2,class:"setting-status success"},us={class:"profile-section"},cs={class:"profile-section"},fs={class:"stat-card"},ms={class:"stat-number"},ps={class:"stat-card"},gs={class:"stat-number"},vs={class:"stat-card"},_s={class:"stat-number"},ys={class:"security-section"},ws={class:"verification-code-input"},bs={class:"form-hint"},hs={class:"password-actions"},Ss={class:"preferences-section"},Vs={class:"preferences-section"},Cs={class:"storage-analysis"},ks={class:"analysis-section"},Ns={class:"type-card"},Us={class:"type-info"},Ps={class:"type-size"},zs={class:"type-count"},Es={class:"type-card"},xs={class:"type-info"},As={class:"type-size"},Is={class:"type-count"},Rs={class:"type-card"},Fs={class:"type-info"},Os={class:"type-size"},qs={class:"type-count"},Ds={class:"analysis-section"},Ws={class:"storage-suggestions"},Js={key:0,class:"suggestion warning"},Ts={key:1,class:"suggestion caution"},Bs={key:2,class:"suggestion good"},$s={class:"storage-cleanup"},js={class:"cleanup-preview"},Ms=kt({__name:"UserCenter",setup(Ls){const O=Vt(),ae=_("profile"),h=_(!1),Z=_(!1),J=_(),T=_(),G=_(!1),x=_(0),R=_(null),B=_(!1),H=_(!1),q=_(!1),K=_(!1),w=_([]),b=I({imageSize:0,videoSize:0,otherSize:0,imageCount:0,videoCount:0,otherCount:0}),d=I({username:"",email:"",display_name:"",bio:"",avatar_url:"",used_storage:0,storage_limit:0,created_at:"",last_login:""}),$=I({totalFiles:0,totalFolders:0,loginCount:0}),f=I({username:"",email:"",display_name:"",bio:""}),V=I({newPassword:"",confirmPassword:"",emailCode:""}),u=I({defaultView:"grid",emailNotifications:!0,storageWarnings:!0,securityAlerts:!0}),v=I({autoRefresh:!0,notifications:!0}),F=_(null),oe=_(3e4),C=_("default"),k=_(!1),le=()=>{F.value&&clearInterval(F.value),v.autoRefresh&&(F.value=setInterval(()=>{Y(!1),de()},oe.value))},re=()=>{F.value&&(clearInterval(F.value),F.value=null)},be=()=>{k.value="Notification"in window,k.value&&(C.value=Notification.permission)},ie=async()=>{if(!k.value)return l.warning("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒé€šçŸ¥åŠŸèƒ½"),!1;if(Notification.permission==="granted")return C.value="granted",!0;if(Notification.permission==="denied")return C.value="denied",l.error("é€šçŸ¥æƒé™å·²è¢«æ‹’ç»ï¼Œè¯·åœ¨æµè§ˆå™¨è®¾ç½®ä¸­æ‰‹åŠ¨å¼€å¯"),!1;try{const a=await Notification.requestPermission();return C.value=a,a==="granted"?(l.success("é€šçŸ¥æƒé™å·²å¼€å¯"),!0):(l.warning("é€šçŸ¥æƒé™è¢«æ‹’ç»"),!1)}catch{return l.error("è¯·æ±‚é€šçŸ¥æƒé™å¤±è´¥"),C.value="denied",!1}},he=(a,e)=>{if(!(!k.value||Notification.permission!=="granted"))try{const r=new Notification(a,{icon:"/favicon.ico",badge:"/favicon.ico",...e});return setTimeout(()=>{r.close()},5e3),r}catch(r){console.error("æ˜¾ç¤ºé€šçŸ¥å¤±è´¥:",r)}},Se=()=>{try{const a=localStorage.getItem("quickSettings");if(a){const e=JSON.parse(a);v.autoRefresh=e.autoRefresh??!0,v.notifications=e.notifications??!0}}catch(a){console.error("åŠ è½½å¿«æ·è®¾ç½®å¤±è´¥:",a)}},Ve=()=>{try{const a=localStorage.getItem("userPreferences");if(a){const e=JSON.parse(a);u.defaultView=e.defaultView??"grid"}}catch(a){console.error("åŠ è½½ç”¨æˆ·åå¥½è®¾ç½®å¤±è´¥:",a)}},Ce=async()=>{var a;try{const e=await S.get("/auth/profile");if(e.data.success){const p=e.data.data;f.email=p.email||"",f.display_name=p.display_name||"",f.bio=p.bio||"",d.email=p.email||"",d.display_name=p.display_name||"",d.bio=p.bio||"",d.username=p.username||"",d.created_at=p.created_at||""}const r=await S.get("/auth/preferences");if(r.data.success){const p=r.data.data;u.defaultView=p.defaultView||"grid"}const n=await S.get("/auth/notification-settings");if(n.data.success){const p=n.data.data;u.emailNotifications=p.emailNotifications??!0,u.storageWarnings=p.storageWarnings??!0,u.securityAlerts=p.securityAlerts??!0}console.log("ç”¨æˆ·è®¾ç½®å·²ä»æœåŠ¡å™¨åŒæ­¥")}catch(e){console.error("ä»æœåŠ¡å™¨åŠ è½½ç”¨æˆ·è®¾ç½®å¤±è´¥:",e),((a=e.response)==null?void 0:a.status)===401?l.warning("ç™»å½•å·²è¿‡æœŸï¼Œä½¿ç”¨æœ¬åœ°è®¾ç½®"):l.warning("æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œä½¿ç”¨æœ¬åœ°è®¾ç½®")}},ke=()=>{try{const a=localStorage.getItem("notificationSettings");if(a){const e=JSON.parse(a);u.emailNotifications=e.emailNotifications??!0,u.storageWarnings=e.storageWarnings??!0,u.securityAlerts=e.securityAlerts??!0}}catch(a){console.error("åŠ è½½é€šçŸ¥è®¾ç½®å¤±è´¥:",a)}},Q=()=>{k.value&&(C.value=Notification.permission,Notification.permission==="denied"&&(v.notifications=!1,localStorage.setItem("quickSettings",JSON.stringify(v))))},Ne=async()=>{be(),k.value&&("permissions"in navigator?navigator.permissions.query({name:"notifications"}).then(a=>{a.addEventListener("change",Q)}).catch(()=>{setInterval(()=>{Notification.permission!==C.value&&Q()},1e3)}):setInterval(()=>{Notification.permission!==C.value&&Q()},1e3)),v.notifications&&k.value&&await ie()},ne=()=>{v.notifications&&A.value>=80&&he("å­˜å‚¨ç©ºé—´è­¦å‘Š",{body:`æ‚¨çš„å­˜å‚¨ç©ºé—´å·²ä½¿ç”¨ ${A.value}%ï¼Œå»ºè®®åŠæ—¶æ¸…ç†`,tag:"storage-warning"})};ye(()=>v.autoRefresh,a=>{a?le():re(),localStorage.setItem("quickSettings",JSON.stringify(v))}),ye(()=>v.notifications,async a=>{a&&(await ie()||(v.notifications=!1)),localStorage.setItem("quickSettings",JSON.stringify(v))});const A=W(()=>{if(!d.storage_limit||d.storage_limit===0||!d.used_storage||d.used_storage===0)return 0;const a=Math.round(d.used_storage/d.storage_limit*100);return console.log("å­˜å‚¨è®¡ç®—:",{used_storage:d.used_storage,storage_limit:d.storage_limit,percentage:a}),a}),Ue=W(()=>{const a=A.value;return a>=90?"#f56c6c":a>=70?"#e6a23c":"#67c23a"}),Pe=W(()=>"https://tukubackend.vtart.cn/api/avatars/upload"),ze=W(()=>({Authorization:`Bearer ${O.token}`})),Ee={email:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±åœ°å€",trigger:"blur"},{type:"email",message:"è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±æ ¼å¼",trigger:"blur"}],display_name:[{required:!0,message:"è¯·è¾“å…¥æ˜µç§°",trigger:"blur"},{min:2,max:20,message:"æ˜µç§°é•¿åº¦åœ¨2-20ä¸ªå­—ç¬¦",trigger:"blur"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9_\s]+$/,message:"æ˜µç§°åªèƒ½åŒ…å«ä¸­æ–‡ã€å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œç©ºæ ¼",trigger:"blur"}],bio:[{max:200,message:"ä¸ªäººç®€ä»‹ä¸èƒ½è¶…è¿‡200ä¸ªå­—ç¬¦",trigger:"blur"}]},xe={newPassword:[{required:!0,message:"è¯·è¾“å…¥æ–°å¯†ç ",trigger:"blur"},{min:6,max:20,message:"å¯†ç é•¿åº¦åœ¨6-20ä¸ªå­—ç¬¦",trigger:"blur"},{pattern:/^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{6,}$/,message:"å¯†ç å¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—",trigger:"blur"}],confirmPassword:[{required:!0,message:"è¯·ç¡®è®¤æ–°å¯†ç ",trigger:"blur"},{validator:(a,e,r)=>{e!==V.newPassword?r(new Error("ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´")):r()},trigger:"blur"}],emailCode:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±éªŒè¯ç ",trigger:"blur"},{len:6,message:"éªŒè¯ç é•¿åº¦ä¸º6ä½",trigger:"blur"},{pattern:/^\d{6}$/,message:"éªŒè¯ç åªèƒ½åŒ…å«æ•°å­—",trigger:"blur"}]},X=async()=>{try{const e=(await S.get("/auth/me")).data.user;console.log("ç”¨æˆ·æ•°æ®:",e),console.log("created_at:",e.created_at),console.log("avatar_urlåŸå§‹:",e.avatar_url),console.log("used_storage:",e.used_storage),console.log("storage_limit:",e.storage_limit);let r=e.avatar_url||"";console.log("avatar_urlå¤„ç†å:",r),Object.assign(d,{username:e.username,email:e.email,display_name:e.display_name||e.username,bio:e.bio||"",avatar_url:r,used_storage:e.used_storage||0,storage_limit:e.storage_limit||0,created_at:e.created_at||new Date().toISOString(),last_login:e.last_login||""}),Object.assign(f,{username:e.username,email:e.email,display_name:e.display_name||e.username,bio:e.bio||""})}catch(a){console.error("åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",a),l.error("åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥")}},de=async()=>{try{const e=(await S.get("/auth/stats")).data.data;Object.assign($,{totalFiles:e.totalFiles||0,totalFolders:e.totalFolders||0,loginCount:e.loginCount||0})}catch(a){console.error("åŠ è½½ç”¨æˆ·ç»Ÿè®¡å¤±è´¥:",a)}},Y=async(a=!0)=>{try{B.value=!0,await X(),await ue(),a&&l.success("å­˜å‚¨ä¿¡æ¯å·²åˆ·æ–°")}catch(e){console.error("åˆ·æ–°å­˜å‚¨ä¿¡æ¯å¤±è´¥:",e),l.error("åˆ·æ–°å­˜å‚¨ä¿¡æ¯å¤±è´¥")}finally{B.value=!1}},ue=async()=>{try{const e=(await S.get("/files/storage-details")).data.data;Object.assign(b,{imageSize:e.imageSize||0,videoSize:e.videoSize||0,otherSize:e.otherSize||0,imageCount:e.imageCount||0,videoCount:e.videoCount||0,otherCount:e.otherCount||0})}catch(a){console.error("åŠ è½½å­˜å‚¨è¯¦æƒ…å¤±è´¥:",a)}},Ae=async()=>{if(w.value.length===0){l.warning("è¯·é€‰æ‹©è¦æ¸…ç†çš„å†…å®¹");return}try{K.value=!0,await S.post("/files/cleanup",{options:w.value}),l.success("å­˜å‚¨æ¸…ç†å®Œæˆ"),q.value=!1,w.value=[],await Y()}catch(a){console.error("å­˜å‚¨æ¸…ç†å¤±è´¥:",a),l.error("å­˜å‚¨æ¸…ç†å¤±è´¥")}finally{K.value=!1}},Ie=W(()=>{let a=0;return w.value&&w.value.includes("duplicates")&&(a+=(b.imageSize||0)*.1),w.value&&w.value.includes("temp")&&(a+=50*1024*1024),w.value&&w.value.includes("large")&&(a+=(b.videoSize||0)*.2),w.value&&w.value.includes("old")&&(a+=(b.otherSize||0)*.3),a}),ce=async()=>{var a,e,r;if(J.value&&ee("profile"))try{await J.value.validate(),h.value=!0;const n={email:f.email,display_name:f.display_name,bio:f.bio},p=await S.put("/auth/profile",n);p.data.success?(l.success("ä¸ªäººä¿¡æ¯ä¿å­˜æˆåŠŸ"),O.updateUser(n),localStorage.setItem("userProfile",JSON.stringify(n)),await X()):l.error(p.data.message||"ä¿å­˜å¤±è´¥")}catch(n){console.error("ä¿å­˜ä¸ªäººä¿¡æ¯å¤±è´¥:",n),((a=n.response)==null?void 0:a.status)===400?l.error(n.response.data.message||"æ•°æ®éªŒè¯å¤±è´¥"):((e=n.response)==null?void 0:e.status)===401?l.error("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•"):((r=n.response)==null?void 0:r.status)===409?l.error("é‚®ç®±å·²è¢«å…¶ä»–ç”¨æˆ·ä½¿ç”¨"):l.error("ä¿å­˜ä¸ªäººä¿¡æ¯å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{h.value=!1}},fe=async()=>{var a,e;if(ee("preferences"))try{h.value=!0;const r={defaultView:u.defaultView},n=await S.put("/auth/preferences",r);n.data.success?(l.success("ç•Œé¢è®¾ç½®ä¿å­˜æˆåŠŸ"),localStorage.setItem("userPreferences",JSON.stringify(r)),window.userPreferences&&(window.userPreferences.defaultView=u.defaultView),window.dispatchEvent(new CustomEvent("preferencesUpdated",{detail:{defaultView:u.defaultView}}))):l.error(n.data.message||"ä¿å­˜å¤±è´¥")}catch(r){console.error("ä¿å­˜ç•Œé¢è®¾ç½®å¤±è´¥:",r),((a=r.response)==null?void 0:a.status)===400?l.error("è®¾ç½®æ•°æ®æ— æ•ˆ"):((e=r.response)==null?void 0:e.status)===401?l.error("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•"):l.error("ä¿å­˜ç•Œé¢è®¾ç½®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{h.value=!1}},me=async()=>{var a,e;if(ee("notifications"))try{h.value=!0;const r={emailNotifications:u.emailNotifications,storageWarnings:u.storageWarnings,securityAlerts:u.securityAlerts},n=await S.put("/auth/notification-settings",r);n.data.success?(l.success("é€šçŸ¥è®¾ç½®ä¿å­˜æˆåŠŸ"),localStorage.setItem("notificationSettings",JSON.stringify(r)),window.notificationSettings&&Object.assign(window.notificationSettings,r),window.dispatchEvent(new CustomEvent("notificationSettingsUpdated",{detail:r})),u.storageWarnings&&ne()):l.error(n.data.message||"ä¿å­˜å¤±è´¥")}catch(r){console.error("ä¿å­˜é€šçŸ¥è®¾ç½®å¤±è´¥:",r),((a=r.response)==null?void 0:a.status)===400?l.error("é€šçŸ¥è®¾ç½®æ•°æ®æ— æ•ˆ"):((e=r.response)==null?void 0:e.status)===401?l.error("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•"):l.error("ä¿å­˜é€šçŸ¥è®¾ç½®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{h.value=!1}},Re=async()=>{if(!d.email){l.error("è¯·å…ˆè®¾ç½®é‚®ç®±åœ°å€");return}try{G.value=!0,await S.post("/auth/send-verification-code",{email:d.email,type:"password_change"}),l.success("éªŒè¯ç å·²å‘é€åˆ°æ‚¨çš„é‚®ç®±"),Fe()}catch(a){console.error("å‘é€éªŒè¯ç å¤±è´¥:",a),l.error("å‘é€éªŒè¯ç å¤±è´¥")}finally{G.value=!1}},Fe=()=>{x.value=60,R.value=setInterval(()=>{x.value--,x.value<=0&&(clearInterval(R.value),R.value=null)},1e3)},pe=()=>{R.value&&(clearInterval(R.value),R.value=null),x.value=0},Oe=async()=>{if(T.value)try{await T.value.validate(),Z.value=!0,await S.put("/auth/password",{new_password:V.newPassword,email_code:V.emailCode}),l.success("å¯†ç ä¿®æ”¹æˆåŠŸ"),Object.assign(V,{newPassword:"",confirmPassword:"",emailCode:""}),T.value.resetFields(),pe()}catch(a){console.error("ä¿®æ”¹å¯†ç å¤±è´¥:",a),l.error("ä¿®æ”¹å¯†ç å¤±è´¥")}finally{Z.value=!1}},qe=a=>{const e=a.type.startsWith("image/"),r=a.size/1024/1024<5;return e?r?!0:(l.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 5MB!"),!1):(l.error("åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶!"),!1)},De=a=>{if(a&&a.success&&a.data&&a.data.url){const r="https://tukubackend.vtart.cn"+a.data.url+"?t="+Date.now();d.avatar_url=r,O.updateUser({avatar_url:r}),l.success(a.message||"å¤´åƒä¸Šä¼ æˆåŠŸ")}else l.error(a.message||"å¤´åƒä¸Šä¼ å¤±è´¥")},ge=a=>{console.error("å¤´åƒåŠ è½½å¤±è´¥:",a),console.log("å¤´åƒURL:",d.avatar_url),l.warning("å¤´åƒåŠ è½½å¤±è´¥ï¼Œå°†æ˜¾ç¤ºé»˜è®¤å¤´åƒ")},We=a=>{if(!a)return"æš‚æ— æ•°æ®";try{const e=new Date(a);return isNaN(e.getTime())?"æ— æ•ˆæ—¥æœŸ":e.toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"æ—¥æœŸæ ¼å¼é”™è¯¯"}},Je=async()=>{try{h.value=!0,J.value&&await ce(),await fe(),await me(),l.success("æ‰€æœ‰è®¾ç½®å·²ä¿å­˜")}catch(a){console.error("ä¿å­˜è®¾ç½®å¤±è´¥:",a),l.error("ä¿å­˜è®¾ç½®å¤±è´¥")}finally{h.value=!1}},ee=a=>{switch(a){case"profile":return!f.email||!f.email.includes("@")?(l.error("è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€"),!1):f.display_name&&f.display_name.length>50?(l.error("æ˜µç§°ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦"),!1):f.bio&&f.bio.length>200?(l.error("ä¸ªäººç®€ä»‹ä¸èƒ½è¶…è¿‡200ä¸ªå­—ç¬¦"),!1):!0;case"preferences":return["grid","list"].includes(u.defaultView)?!0:(l.error("é»˜è®¤è§†å›¾è®¾ç½®æ— æ•ˆ"),!1);case"notifications":return typeof u.emailNotifications!="boolean"||typeof u.storageWarnings!="boolean"||typeof u.securityAlerts!="boolean"?(l.error("é€šçŸ¥è®¾ç½®æ•°æ®æ— æ•ˆ"),!1):!0;default:return!1}},Te=()=>{St.confirm("æ‚¨å°†è·³è½¬åˆ°å¿˜è®°å¯†ç é¡µé¢ï¼Œé€šè¿‡é‚®ç®±éªŒè¯æ¥é‡ç½®å¯†ç ã€‚æ˜¯å¦ç»§ç»­ï¼Ÿ","ç¡®è®¤è·³è½¬",{confirmButtonText:"ç»§ç»­",cancelButtonText:"å–æ¶ˆ",type:"info",customClass:"custom-message-box"}).then(()=>{router.push("/forgot-password")}).catch(()=>{})};return Nt(async()=>{console.log("UserCenterç»„ä»¶å¼€å§‹åŠ è½½...");try{console.log("1. åŠ è½½ç”¨æˆ·åŸºæœ¬ä¿¡æ¯..."),await X(),console.log("2. åŠ è½½ç”¨æˆ·è®¾ç½®..."),await Ce(),console.log("3. åŠ è½½æœ¬åœ°è®¾ç½®..."),Se(),Ve(),ke(),console.log("4. åˆå§‹åŒ–é€šçŸ¥åŠŸèƒ½..."),await Ne(),console.log("5. åŠ è½½ç”¨æˆ·ç»Ÿè®¡..."),await de(),console.log("6. åŠ è½½å­˜å‚¨è¯¦æƒ…..."),await ue(),v.autoRefresh&&(console.log("7. å¯åŠ¨è‡ªåŠ¨åˆ·æ–°..."),le()),console.log("8. æ£€æŸ¥å­˜å‚¨è­¦å‘Š..."),ne(),console.log("UserCenterç»„ä»¶åŠ è½½å®Œæˆ!")}catch(a){console.error("UserCenterç»„ä»¶åŠ è½½å¤±è´¥:",a),l.error("é¡µé¢åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•")}}),Ut(()=>{re(),pe()}),(a,e)=>{const r=Xe,n=He,p=st,Be=at,$e=lt,j=tt,je=it,D=dt,U=et,P=pt,y=mt,M=ft,te=Ke,se=ct,ve=vt,Me=gt,Le=ut,_e=Qe,L=ht,Ze=bt;return E(),z("div",Pt,[t("div",zt,[t("div",Et,[e[21]||(e[21]=t("div",{class:"header-left"},[t("h1",{class:"page-title"},"ä¸ªäººè®¾ç½®"),t("p",{class:"page-subtitle"},"ç®¡ç†æ‚¨çš„ä¸ªäººä¿¡æ¯å’Œç³»ç»Ÿè®¾ç½®")],-1)),t("div",xt,[s(n,{type:"primary",onClick:Je,loading:h.value},{default:o(()=>[s(r,null,{default:o(()=>[s(g(Ye))]),_:1}),e[20]||(e[20]=m(" ä¿å­˜æ›´æ”¹ ",-1))]),_:1},8,["loading"])])])]),t("div",At,[s(te,{gutter:24},{default:o(()=>[s(U,{xs:24,sm:24,md:8,lg:6,xl:6},{default:o(()=>[s(j,{class:"user-info-card"},{default:o(()=>[t("div",It,[t("div",Rt,[s(p,{size:100,src:d.avatar_url,class:"user-avatar",onError:ge},{default:o(()=>{var i;return[m(c((i=d.username)==null?void 0:i.charAt(0).toUpperCase()),1)]}),_:1},8,["src"]),t("div",Ft,[s(Be,{action:Pe.value,headers:ze.value,"show-file-list":!1,"before-upload":qe,"on-success":De,"on-error":ge,accept:"image/*"},{default:o(()=>[s(n,{type:"primary",size:"small",circle:""},{default:o(()=>[s(r,null,{default:o(()=>[s(g(ot))]),_:1})]),_:1})]),_:1},8,["action","headers"])])]),t("div",Ot,[t("h3",qt,c(d.username),1),t("p",Dt,[s($e,{type:g(O).isAdmin?"danger":"primary"},{default:o(()=>[m(c(g(O).isAdmin?"ç®¡ç†å‘˜":"æ™®é€šç”¨æˆ·"),1)]),_:1},8,["type"])]),t("p",Wt,c(d.email),1)])])]),_:1}),s(j,{class:"storage-card"},{default:o(()=>[t("div",Jt,[e[23]||(e[23]=t("h4",null,"å­˜å‚¨ä½¿ç”¨æƒ…å†µ",-1)),s(n,{type:"text",size:"small",onClick:Y,loading:B.value},{default:o(()=>[s(r,null,{default:o(()=>[s(g(rt))]),_:1}),e[22]||(e[22]=m(" åˆ·æ–° ",-1))]),_:1},8,["loading"])]),t("div",Tt,[s(je,{percentage:A.value,color:Ue.value,"stroke-width":8},{default:o(({percentage:i})=>[m(c(g(Ct)(i)),1)]),_:1},8,["percentage","color"]),t("div",Bt,[t("span",$t,c(g(N)(d.used_storage)),1),t("span",jt,"/ "+c(g(N)(d.storage_limit)),1)])]),t("div",Mt,[t("div",Lt,[e[24]||(e[24]=t("span",{class:"label"},"å›¾ç‰‡æ–‡ä»¶",-1)),t("span",Zt,c(g(N)(b.imageSize)),1)]),t("div",Gt,[e[25]||(e[25]=t("span",{class:"label"},"è§†é¢‘æ–‡ä»¶",-1)),t("span",Ht,c(g(N)(b.videoSize)),1)]),t("div",Kt,[e[26]||(e[26]=t("span",{class:"label"},"å…¶ä»–æ–‡ä»¶",-1)),t("span",Qt,c(g(N)(b.otherSize)),1)])]),t("div",Xt,[t("div",Yt,[s(n,{type:"primary",size:"small",onClick:e[0]||(e[0]=i=>q.value=!0),disabled:A.value<80},{default:o(()=>[s(r,null,{default:o(()=>[s(g(nt))]),_:1}),e[27]||(e[27]=m(" æ¸…ç†å­˜å‚¨ ",-1))]),_:1},8,["disabled"])]),t("div",es,[s(n,{type:"text",size:"small",onClick:e[1]||(e[1]=i=>H.value=!0)},{default:o(()=>[...e[28]||(e[28]=[m(" è¯¦ç»†åˆ†æ ",-1)])]),_:1})])])]),_:1}),s(j,{class:"quick-settings-card"},{default:o(()=>[e[31]||(e[31]=t("div",{class:"quick-settings-header"},[t("h4",null,"å¿«æ·è®¾ç½®")],-1)),t("div",ts,[t("div",ss,[e[29]||(e[29]=t("span",{class:"setting-label"},"è‡ªåŠ¨åˆ·æ–°",-1)),t("div",as,[s(D,{modelValue:v.autoRefresh,"onUpdate:modelValue":e[2]||(e[2]=i=>v.autoRefresh=i),disabled:B.value},null,8,["modelValue","disabled"]),v.autoRefresh?(E(),z("span",os,c(oe.value/1e3)+"ç§’ ",1)):we("",!0)])]),t("div",ls,[e[30]||(e[30]=t("span",{class:"setting-label"},"é€šçŸ¥æé†’",-1)),t("div",rs,[s(D,{modelValue:v.notifications,"onUpdate:modelValue":e[3]||(e[3]=i=>v.notifications=i),disabled:!k.value},null,8,["modelValue","disabled"]),k.value?C.value==="denied"?(E(),z("span",ns," å·²æ‹’ç» ")):C.value==="granted"?(E(),z("span",ds," å·²å¼€å¯ ")):we("",!0):(E(),z("span",is," ä¸æ”¯æŒ "))])])])]),_:1})]),_:1}),s(U,{xs:24,sm:24,md:16,lg:18,xl:18},{default:o(()=>[s(j,{class:"settings-card"},{default:o(()=>[s(Le,{modelValue:ae.value,"onUpdate:modelValue":e[15]||(e[15]=i=>ae.value=i),class:"settings-tabs"},{default:o(()=>[s(se,{label:"ä¸ªäººä¿¡æ¯",name:"profile"},{default:o(()=>[t("div",us,[e[36]||(e[36]=t("h4",null,"åŸºæœ¬ä¿¡æ¯",-1)),s(M,{ref_key:"profileFormRef",ref:J,model:f,rules:Ee,"label-width":"100px",class:"profile-form"},{default:o(()=>[s(y,{label:"ç”¨æˆ·å",prop:"username"},{default:o(()=>[s(P,{modelValue:f.username,"onUpdate:modelValue":e[4]||(e[4]=i=>f.username=i),placeholder:"è¯·è¾“å…¥ç”¨æˆ·å",disabled:!0},null,8,["modelValue"]),e[32]||(e[32]=t("div",{class:"form-hint"},"ç”¨æˆ·åä¸å¯ä¿®æ”¹",-1))]),_:1}),s(y,{label:"é‚®ç®±åœ°å€",prop:"email"},{default:o(()=>[s(P,{modelValue:f.email,"onUpdate:modelValue":e[5]||(e[5]=i=>f.email=i),placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€"},null,8,["modelValue"]),e[33]||(e[33]=t("div",{class:"form-hint"},"ç”¨äºæ¥æ”¶ç³»ç»Ÿé€šçŸ¥å’Œæ‰¾å›å¯†ç ",-1))]),_:1}),s(y,{label:"æ˜µç§°",prop:"display_name"},{default:o(()=>[s(P,{modelValue:f.display_name,"onUpdate:modelValue":e[6]||(e[6]=i=>f.display_name=i),placeholder:"è¯·è¾“å…¥æ˜µç§°"},null,8,["modelValue"]),e[34]||(e[34]=t("div",{class:"form-hint"},"åœ¨å…¶ä»–ç”¨æˆ·é¢å‰æ˜¾ç¤ºçš„åç§°",-1))]),_:1}),s(y,{label:"ä¸ªäººç®€ä»‹",prop:"bio"},{default:o(()=>[s(P,{modelValue:f.bio,"onUpdate:modelValue":e[7]||(e[7]=i=>f.bio=i),type:"textarea",rows:3,placeholder:"ä»‹ç»ä¸€ä¸‹è‡ªå·±...",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),s(y,null,{default:o(()=>[s(n,{type:"primary",onClick:ce,loading:h.value},{default:o(()=>[...e[35]||(e[35]=[m(" ä¿å­˜ä¸ªäººä¿¡æ¯ ",-1)])]),_:1},8,["loading"])]),_:1}),s(y,{label:"æ³¨å†Œæ—¶é—´"},{default:o(()=>[s(P,{value:We(d.created_at),disabled:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),t("div",cs,[e[40]||(e[40]=t("h4",null,"è´¦æˆ·ç»Ÿè®¡",-1)),s(te,{gutter:16},{default:o(()=>[s(U,{span:8},{default:o(()=>[t("div",fs,[t("div",ms,c($.totalFiles),1),e[37]||(e[37]=t("div",{class:"stat-label"},"æ–‡ä»¶æ€»æ•°",-1))])]),_:1}),s(U,{span:8},{default:o(()=>[t("div",ps,[t("div",gs,c($.totalFolders),1),e[38]||(e[38]=t("div",{class:"stat-label"},"æ–‡ä»¶å¤¹æ•°",-1))])]),_:1}),s(U,{span:8},{default:o(()=>[t("div",vs,[t("div",_s,c($.loginCount),1),e[39]||(e[39]=t("div",{class:"stat-label"},"ç™»å½•æ¬¡æ•°",-1))])]),_:1})]),_:1})])]),_:1}),s(se,{label:"å®‰å…¨è®¾ç½®",name:"security"},{default:o(()=>[t("div",ys,[e[44]||(e[44]=t("h4",null,"å¯†ç å®‰å…¨",-1)),s(M,{ref_key:"passwordFormRef",ref:T,model:V,rules:xe,"label-width":"100px",class:"password-form"},{default:o(()=>[s(y,{label:"æ–°å¯†ç ",prop:"newPassword"},{default:o(()=>[s(P,{modelValue:V.newPassword,"onUpdate:modelValue":e[8]||(e[8]=i=>V.newPassword=i),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ","show-password":""},null,8,["modelValue"])]),_:1}),s(y,{label:"ç¡®è®¤å¯†ç ",prop:"confirmPassword"},{default:o(()=>[s(P,{modelValue:V.confirmPassword,"onUpdate:modelValue":e[9]||(e[9]=i=>V.confirmPassword=i),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ","show-password":""},null,8,["modelValue"])]),_:1}),s(y,{label:"é‚®ç®±éªŒè¯ç ",prop:"emailCode"},{default:o(()=>[t("div",ws,[s(P,{modelValue:V.emailCode,"onUpdate:modelValue":e[10]||(e[10]=i=>V.emailCode=i),placeholder:"è¯·è¾“å…¥é‚®ç®±éªŒè¯ç ",maxlength:"6"},null,8,["modelValue"]),s(n,{type:"primary",disabled:x.value>0||!d.email,onClick:Re,loading:G.value,class:"send-code-btn"},{default:o(()=>[m(c(x.value>0?`${x.value}ç§’åé‡å‘`:"å‘é€éªŒè¯ç "),1)]),_:1},8,["disabled","loading"])]),t("div",bs," éªŒè¯ç å°†å‘é€åˆ°æ‚¨çš„é‚®ç®±ï¼š"+c(d.email),1)]),_:1}),s(y,null,{default:o(()=>[t("div",hs,[s(n,{type:"primary",onClick:Oe,loading:Z.value},{default:o(()=>[...e[41]||(e[41]=[m(" ä¿®æ”¹å¯†ç  ",-1)])]),_:1},8,["loading"]),s(n,{type:"text",class:"forgot-password",onClick:Te},{default:o(()=>[...e[42]||(e[42]=[m(" å¿˜è®°å¯†ç ï¼Ÿ ",-1)])]),_:1})]),e[43]||(e[43]=t("div",{class:"form-hint"}," å¦‚æœå¿˜è®°å½“å‰å¯†ç ï¼Œå¯ä»¥é€šè¿‡é‚®ç®±éªŒè¯é‡ç½®å¯†ç  ",-1))]),_:1})]),_:1},8,["model"])])]),_:1}),s(se,{label:"åå¥½è®¾ç½®",name:"preferences"},{default:o(()=>[t("div",Ss,[e[48]||(e[48]=t("h4",null,"ç•Œé¢è®¾ç½®",-1)),s(M,{"label-width":"100px",class:"preferences-form"},{default:o(()=>[s(y,{label:"é»˜è®¤è§†å›¾"},{default:o(()=>[s(Me,{modelValue:u.defaultView,"onUpdate:modelValue":e[11]||(e[11]=i=>u.defaultView=i)},{default:o(()=>[s(ve,{label:"grid"},{default:o(()=>[...e[45]||(e[45]=[m("ç½‘æ ¼è§†å›¾",-1)])]),_:1}),s(ve,{label:"list"},{default:o(()=>[...e[46]||(e[46]=[m("åˆ—è¡¨è§†å›¾",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(y,null,{default:o(()=>[s(n,{type:"primary",onClick:fe,loading:h.value},{default:o(()=>[...e[47]||(e[47]=[m(" ä¿å­˜ç•Œé¢è®¾ç½® ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),t("div",Vs,[e[50]||(e[50]=t("h4",null,"é€šçŸ¥è®¾ç½®",-1)),s(M,{"label-width":"100px",class:"preferences-form"},{default:o(()=>[s(y,{label:"é‚®ä»¶é€šçŸ¥"},{default:o(()=>[s(D,{modelValue:u.emailNotifications,"onUpdate:modelValue":e[12]||(e[12]=i=>u.emailNotifications=i)},null,8,["modelValue"])]),_:1}),s(y,{label:"å­˜å‚¨è­¦å‘Š"},{default:o(()=>[s(D,{modelValue:u.storageWarnings,"onUpdate:modelValue":e[13]||(e[13]=i=>u.storageWarnings=i)},null,8,["modelValue"])]),_:1}),s(y,{label:"å®‰å…¨æé†’"},{default:o(()=>[s(D,{modelValue:u.securityAlerts,"onUpdate:modelValue":e[14]||(e[14]=i=>u.securityAlerts=i)},null,8,["modelValue"])]),_:1}),s(y,null,{default:o(()=>[s(n,{type:"primary",onClick:me,loading:h.value},{default:o(()=>[...e[49]||(e[49]=[m(" ä¿å­˜é€šçŸ¥è®¾ç½® ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),s(_e,{modelValue:H.value,"onUpdate:modelValue":e[16]||(e[16]=i=>H.value=i),title:"å­˜å‚¨è¯¦ç»†åˆ†æ",width:"600px"},{default:o(()=>[t("div",Cs,[t("div",ks,[e[57]||(e[57]=t("h4",null,"æ–‡ä»¶ç±»å‹åˆ†å¸ƒ",-1)),s(te,{gutter:16},{default:o(()=>[s(U,{span:8},{default:o(()=>[t("div",Ns,[e[52]||(e[52]=t("div",{class:"type-icon image"},"ğŸ“·",-1)),t("div",Us,[e[51]||(e[51]=t("div",{class:"type-name"},"å›¾ç‰‡",-1)),t("div",Ps,c(g(N)(b.imageSize)),1),t("div",zs,c(b.imageCount)+" ä¸ªæ–‡ä»¶",1)])])]),_:1}),s(U,{span:8},{default:o(()=>[t("div",Es,[e[54]||(e[54]=t("div",{class:"type-icon video"},"ğŸ¥",-1)),t("div",xs,[e[53]||(e[53]=t("div",{class:"type-name"},"è§†é¢‘",-1)),t("div",As,c(g(N)(b.videoSize)),1),t("div",Is,c(b.videoCount)+" ä¸ªæ–‡ä»¶",1)])])]),_:1}),s(U,{span:8},{default:o(()=>[t("div",Rs,[e[56]||(e[56]=t("div",{class:"type-icon other"},"ğŸ“„",-1)),t("div",Fs,[e[55]||(e[55]=t("div",{class:"type-name"},"å…¶ä»–",-1)),t("div",Os,c(g(N)(b.otherSize)),1),t("div",qs,c(b.otherCount)+" ä¸ªæ–‡ä»¶",1)])])]),_:1})]),_:1})]),t("div",Ds,[e[61]||(e[61]=t("h4",null,"å­˜å‚¨å»ºè®®",-1)),t("div",Ws,[A.value>=90?(E(),z("div",Js,[s(r,null,{default:o(()=>[s(g(_t))]),_:1}),e[58]||(e[58]=t("span",null,"å­˜å‚¨ç©ºé—´ä¸¥é‡ä¸è¶³ï¼Œå»ºè®®ç«‹å³æ¸…ç†æ–‡ä»¶",-1))])):A.value>=80?(E(),z("div",Ts,[s(r,null,{default:o(()=>[s(g(yt))]),_:1}),e[59]||(e[59]=t("span",null,"å­˜å‚¨ç©ºé—´ä½¿ç”¨ç‡è¾ƒé«˜ï¼Œå»ºè®®é€‚å½“æ¸…ç†",-1))])):(E(),z("div",Bs,[s(r,null,{default:o(()=>[s(g(wt))]),_:1}),e[60]||(e[60]=t("span",null,"å­˜å‚¨ç©ºé—´ä½¿ç”¨æ­£å¸¸",-1))]))])])])]),_:1},8,["modelValue"]),s(_e,{modelValue:q.value,"onUpdate:modelValue":e[19]||(e[19]=i=>q.value=i),title:"å­˜å‚¨æ¸…ç†",width:"500px"},{footer:o(()=>[s(n,{onClick:e[18]||(e[18]=i=>q.value=!1)},{default:o(()=>[...e[68]||(e[68]=[m("å–æ¶ˆ",-1)])]),_:1}),s(n,{type:"primary",onClick:Ae,loading:K.value},{default:o(()=>[...e[69]||(e[69]=[m(" å¼€å§‹æ¸…ç† ",-1)])]),_:1},8,["loading"])]),default:o(()=>[t("div",$s,[e[67]||(e[67]=t("p",null,"é€‰æ‹©è¦æ¸…ç†çš„å†…å®¹ï¼š",-1)),s(Ze,{modelValue:w.value,"onUpdate:modelValue":e[17]||(e[17]=i=>w.value=i)},{default:o(()=>[s(L,{label:"duplicates"},{default:o(()=>[...e[62]||(e[62]=[m("é‡å¤æ–‡ä»¶",-1)])]),_:1}),s(L,{label:"temp"},{default:o(()=>[...e[63]||(e[63]=[m("ä¸´æ—¶æ–‡ä»¶",-1)])]),_:1}),s(L,{label:"large"},{default:o(()=>[...e[64]||(e[64]=[m("å¤§æ–‡ä»¶ï¼ˆ>10MBï¼‰",-1)])]),_:1}),s(L,{label:"old"},{default:o(()=>[...e[65]||(e[65]=[m("30å¤©å‰çš„æ–‡ä»¶",-1)])]),_:1})]),_:1},8,["modelValue"]),t("div",js,[t("p",null,[e[66]||(e[66]=m("é¢„è®¡å¯é‡Šæ”¾ç©ºé—´ï¼š",-1)),t("strong",null,c(g(N)(Ie.value)),1)])])])]),_:1},8,["modelValue"])])}}}),ca=Ge(Ms,[["__scopeId","data-v-6e9d84ef"]]);export{ca as default};
