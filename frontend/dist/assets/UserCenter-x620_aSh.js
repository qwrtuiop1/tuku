import{_ as Ge}from"./_plugin-vue_export-helper-BwE83l92.js";/* empty css                    *//* empty css                  *//* empty css                   *//* empty css                       *//* empty css               *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 *//* empty css                    *//* empty css                *//* empty css               *//* empty css                  *//* empty css                  */import{E as l,c as He,aq as Ke,Z as Qe,b as Xe,w as Ye,ar as et,y as tt,G as st,aD as at,aE as ot,ap as lt,C as rt,J as it,a9 as nt,aA as ut,aF as dt,aG as ct,d as ft,e as mt,f as pt,aH as gt,aI as vt,aJ as _t,x as yt,aK as wt,aC as bt,h as ht,W as St}from"./element-CHj0RLGm.js";import{u as Vt,a as S}from"./index-BhsWQ3MY.js";import{b as Ct,f as N}from"./helpers-iwoUo1o7.js";import{y as kt,r as _,l as I,w as ye,c as W,j as Nt,U as Ut,z,B as t,R as a,J as o,A as E,O as m,u as g,P as c,L as we}from"./vendor-BcB6VvZI.js";const Pt={class:"user-center-page"},zt={class:"page-header"},Et={class:"header-content"},xt={class:"header-actions"},At={class:"user-center-content"},It={class:"user-avatar-section"},Rt={class:"avatar-container"},Ft={class:"avatar-overlay"},Ot={class:"user-basic-info"},qt={class:"username"},Dt={class:"user-role"},Wt={class:"user-email"},Jt={class:"storage-header"},Tt={class:"storage-progress"},Bt={class:"storage-info"},$t={class:"used"},jt={class:"total"},Mt={class:"storage-details"},Lt={class:"storage-item"},Zt={class:"value"},Gt={class:"storage-item"},Ht={class:"value"},Kt={class:"storage-item"},Qt={class:"value"},Xt={class:"storage-actions"},Yt={class:"action-button-wrapper"},es={class:"action-button-wrapper"},ts={class:"quick-settings"},ss={class:"setting-item"},as={class:"setting-control"},os={key:0,class:"setting-status"},ls={class:"setting-item"},rs={class:"setting-control"},is={key:0,class:"setting-status"},ns={key:1,class:"setting-status"},us={key:2,class:"setting-status success"},ds={class:"profile-section"},cs={class:"profile-section"},fs={class:"stat-card"},ms={class:"stat-number"},ps={class:"stat-card"},gs={class:"stat-number"},vs={class:"stat-card"},_s={class:"stat-number"},ys={class:"security-section"},ws={class:"verification-code-input"},bs={class:"form-hint"},hs={class:"password-actions"},Ss={class:"preferences-section"},Vs={class:"preferences-section"},Cs={class:"storage-analysis"},ks={class:"analysis-section"},Ns={class:"type-card"},Us={class:"type-info"},Ps={class:"type-size"},zs={class:"type-count"},Es={class:"type-card"},xs={class:"type-info"},As={class:"type-size"},Is={class:"type-count"},Rs={class:"type-card"},Fs={class:"type-info"},Os={class:"type-size"},qs={class:"type-count"},Ds={class:"analysis-section"},Ws={class:"storage-suggestions"},Js={key:0,class:"suggestion warning"},Ts={key:1,class:"suggestion caution"},Bs={key:2,class:"suggestion good"},$s={class:"storage-cleanup"},js={class:"cleanup-preview"},Ms=kt({__name:"UserCenter",setup(Ls){const O=Vt(),ae=_("profile"),h=_(!1),Z=_(!1),J=_(),T=_(),G=_(!1),x=_(0),R=_(null),B=_(!1),H=_(!1),q=_(!1),K=_(!1),w=_([]),b=I({imageSize:0,videoSize:0,otherSize:0,imageCount:0,videoCount:0,otherCount:0}),u=I({username:"",email:"",display_name:"",bio:"",avatar_url:"",used_storage:0,storage_limit:0,created_at:"",last_login:""}),$=I({totalFiles:0,totalFolders:0,loginCount:0}),f=I({username:"",email:"",display_name:"",bio:""}),V=I({newPassword:"",confirmPassword:"",emailCode:""}),d=I({defaultView:"grid",emailNotifications:!0,storageWarnings:!0,securityAlerts:!0}),v=I({autoRefresh:!0,notifications:!0}),F=_(null),oe=_(3e4),C=_("default"),k=_(!1),le=()=>{F.value&&clearInterval(F.value),v.autoRefresh&&(F.value=setInterval(()=>{Y(!1),ue()},oe.value))},re=()=>{F.value&&(clearInterval(F.value),F.value=null)},be=()=>{k.value="Notification"in window,k.value&&(C.value=Notification.permission)},ie=async()=>{if(!k.value)return l.warning("您的浏览器不支持通知功能"),!1;if(Notification.permission==="granted")return C.value="granted",!0;if(Notification.permission==="denied")return C.value="denied",l.error("通知权限已被拒绝，请在浏览器设置中手动开启"),!1;try{const s=await Notification.requestPermission();return C.value=s,s==="granted"?(l.success("通知权限已开启"),!0):(l.warning("通知权限被拒绝"),!1)}catch{return l.error("请求通知权限失败"),C.value="denied",!1}},he=(s,e)=>{if(!(!k.value||Notification.permission!=="granted"))try{const r=new Notification(s,{icon:"/favicon.ico",badge:"/favicon.ico",...e});return setTimeout(()=>{r.close()},5e3),r}catch(r){console.error("显示通知失败:",r)}},Se=()=>{try{const s=localStorage.getItem("quickSettings");if(s){const e=JSON.parse(s);v.autoRefresh=e.autoRefresh??!0,v.notifications=e.notifications??!0}}catch(s){console.error("加载快捷设置失败:",s)}},Ve=()=>{try{const s=localStorage.getItem("userPreferences");if(s){const e=JSON.parse(s);d.defaultView=e.defaultView??"grid"}}catch(s){console.error("加载用户偏好设置失败:",s)}},Ce=async()=>{var s;try{const e=await S.get("/auth/profile");if(e.data.success){const p=e.data.data;f.email=p.email||"",f.display_name=p.display_name||"",f.bio=p.bio||"",u.email=p.email||"",u.display_name=p.display_name||"",u.bio=p.bio||"",u.username=p.username||"",u.created_at=p.created_at||""}const r=await S.get("/auth/preferences");if(r.data.success){const p=r.data.data;d.defaultView=p.defaultView||"grid"}const n=await S.get("/auth/notification-settings");if(n.data.success){const p=n.data.data;d.emailNotifications=p.emailNotifications??!0,d.storageWarnings=p.storageWarnings??!0,d.securityAlerts=p.securityAlerts??!0}console.log("用户设置已从服务器同步")}catch(e){console.error("从服务器加载用户设置失败:",e),((s=e.response)==null?void 0:s.status)===401?l.warning("登录已过期，使用本地设置"):l.warning("无法连接到服务器，使用本地设置")}},ke=()=>{try{const s=localStorage.getItem("notificationSettings");if(s){const e=JSON.parse(s);d.emailNotifications=e.emailNotifications??!0,d.storageWarnings=e.storageWarnings??!0,d.securityAlerts=e.securityAlerts??!0}}catch(s){console.error("加载通知设置失败:",s)}},Q=()=>{k.value&&(C.value=Notification.permission,Notification.permission==="denied"&&(v.notifications=!1,localStorage.setItem("quickSettings",JSON.stringify(v))))},Ne=async()=>{be(),k.value&&("permissions"in navigator?navigator.permissions.query({name:"notifications"}).then(s=>{s.addEventListener("change",Q)}).catch(()=>{setInterval(()=>{Notification.permission!==C.value&&Q()},1e3)}):setInterval(()=>{Notification.permission!==C.value&&Q()},1e3)),v.notifications&&k.value&&await ie()},ne=()=>{v.notifications&&A.value>=80&&he("存储空间警告",{body:`您的存储空间已使用 ${A.value}%，建议及时清理`,tag:"storage-warning"})};ye(()=>v.autoRefresh,s=>{s?le():re(),localStorage.setItem("quickSettings",JSON.stringify(v))}),ye(()=>v.notifications,async s=>{s&&(await ie()||(v.notifications=!1)),localStorage.setItem("quickSettings",JSON.stringify(v))});const A=W(()=>{if(!u.storage_limit||u.storage_limit===0||!u.used_storage||u.used_storage===0)return 0;const s=Math.round(u.used_storage/u.storage_limit*100);return console.log("存储计算:",{used_storage:u.used_storage,storage_limit:u.storage_limit,percentage:s}),s}),Ue=W(()=>{const s=A.value;return s>=90?"#f56c6c":s>=70?"#e6a23c":"#67c23a"}),Pe=W(()=>"https://tukubackend.vtart.cn/api/avatars/upload"),ze=W(()=>({Authorization:`Bearer ${O.token}`})),Ee={email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],display_name:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:20,message:"昵称长度在2-20个字符",trigger:"blur"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9_\s]+$/,message:"昵称只能包含中文、字母、数字、下划线和空格",trigger:"blur"}],bio:[{max:200,message:"个人简介不能超过200个字符",trigger:"blur"}]},xe={newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6-20个字符",trigger:"blur"},{pattern:/^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{6,}$/,message:"密码必须包含字母和数字",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(s,e,r)=>{e!==V.newPassword?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}],emailCode:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"},{len:6,message:"验证码长度为6位",trigger:"blur"},{pattern:/^\d{6}$/,message:"验证码只能包含数字",trigger:"blur"}]},X=async()=>{try{const e=(await S.get("/auth/me")).data.user;console.log("用户数据:",e),console.log("created_at:",e.created_at),console.log("avatar_url原始:",e.avatar_url),console.log("used_storage:",e.used_storage),console.log("storage_limit:",e.storage_limit);let r=e.avatar_url||"";console.log("avatar_url处理后:",r),Object.assign(u,{username:e.username,email:e.email,display_name:e.display_name||e.username,bio:e.bio||"",avatar_url:r,used_storage:e.used_storage||0,storage_limit:e.storage_limit||0,created_at:e.created_at||new Date().toISOString(),last_login:e.last_login||""}),Object.assign(f,{username:e.username,email:e.email,display_name:e.display_name||e.username,bio:e.bio||""})}catch(s){console.error("加载用户信息失败:",s),l.error("加载用户信息失败")}},ue=async()=>{try{const e=(await S.get("/auth/stats")).data.data;Object.assign($,{totalFiles:e.totalFiles||0,totalFolders:e.totalFolders||0,loginCount:e.loginCount||0})}catch(s){console.error("加载用户统计失败:",s)}},Y=async(s=!0)=>{try{B.value=!0,await X(),await de(),s&&l.success("存储信息已刷新")}catch(e){console.error("刷新存储信息失败:",e),l.error("刷新存储信息失败")}finally{B.value=!1}},de=async()=>{try{const e=(await S.get("/files/storage-details")).data.data;Object.assign(b,{imageSize:e.imageSize||0,videoSize:e.videoSize||0,otherSize:e.otherSize||0,imageCount:e.imageCount||0,videoCount:e.videoCount||0,otherCount:e.otherCount||0})}catch(s){console.error("加载存储详情失败:",s)}},Ae=async()=>{if(w.value.length===0){l.warning("请选择要清理的内容");return}try{K.value=!0,await S.post("/files/cleanup",{options:w.value}),l.success("存储清理完成"),q.value=!1,w.value=[],await Y()}catch(s){console.error("存储清理失败:",s),l.error("存储清理失败")}finally{K.value=!1}},Ie=W(()=>{let s=0;return w.value&&w.value.includes("duplicates")&&(s+=(b.imageSize||0)*.1),w.value&&w.value.includes("temp")&&(s+=50*1024*1024),w.value&&w.value.includes("large")&&(s+=(b.videoSize||0)*.2),w.value&&w.value.includes("old")&&(s+=(b.otherSize||0)*.3),s}),ce=async()=>{var s,e,r;if(J.value&&ee("profile"))try{await J.value.validate(),h.value=!0;const n={email:f.email,display_name:f.display_name,bio:f.bio},p=await S.put("/auth/profile",n);p.data.success?(l.success("个人信息保存成功"),O.updateUser(n),localStorage.setItem("userProfile",JSON.stringify(n)),await X()):l.error(p.data.message||"保存失败")}catch(n){console.error("保存个人信息失败:",n),((s=n.response)==null?void 0:s.status)===400?l.error(n.response.data.message||"数据验证失败"):((e=n.response)==null?void 0:e.status)===401?l.error("登录已过期，请重新登录"):((r=n.response)==null?void 0:r.status)===409?l.error("邮箱已被其他用户使用"):l.error("保存个人信息失败，请稍后重试")}finally{h.value=!1}},fe=async()=>{var s,e;if(ee("preferences"))try{h.value=!0;const r={defaultView:d.defaultView},n=await S.put("/auth/preferences",r);n.data.success?(l.success("界面设置保存成功"),localStorage.setItem("userPreferences",JSON.stringify(r)),window.userPreferences&&(window.userPreferences.defaultView=d.defaultView),window.dispatchEvent(new CustomEvent("preferencesUpdated",{detail:{defaultView:d.defaultView}}))):l.error(n.data.message||"保存失败")}catch(r){console.error("保存界面设置失败:",r),((s=r.response)==null?void 0:s.status)===400?l.error("设置数据无效"):((e=r.response)==null?void 0:e.status)===401?l.error("登录已过期，请重新登录"):l.error("保存界面设置失败，请稍后重试")}finally{h.value=!1}},me=async()=>{var s,e;if(ee("notifications"))try{h.value=!0;const r={emailNotifications:d.emailNotifications,storageWarnings:d.storageWarnings,securityAlerts:d.securityAlerts},n=await S.put("/auth/notification-settings",r);n.data.success?(l.success("通知设置保存成功"),localStorage.setItem("notificationSettings",JSON.stringify(r)),window.notificationSettings&&Object.assign(window.notificationSettings,r),window.dispatchEvent(new CustomEvent("notificationSettingsUpdated",{detail:r})),d.storageWarnings&&ne()):l.error(n.data.message||"保存失败")}catch(r){console.error("保存通知设置失败:",r),((s=r.response)==null?void 0:s.status)===400?l.error("通知设置数据无效"):((e=r.response)==null?void 0:e.status)===401?l.error("登录已过期，请重新登录"):l.error("保存通知设置失败，请稍后重试")}finally{h.value=!1}},Re=async()=>{if(!u.email){l.error("请先设置邮箱地址");return}try{G.value=!0,await S.post("/auth/send-verification-code",{email:u.email,type:"password_change"}),l.success("验证码已发送到您的邮箱"),Fe()}catch(s){console.error("发送验证码失败:",s),l.error("发送验证码失败")}finally{G.value=!1}},Fe=()=>{x.value=60,R.value=setInterval(()=>{x.value--,x.value<=0&&(clearInterval(R.value),R.value=null)},1e3)},pe=()=>{R.value&&(clearInterval(R.value),R.value=null),x.value=0},Oe=async()=>{if(T.value)try{await T.value.validate(),Z.value=!0,await S.put("/auth/password",{new_password:V.newPassword,email_code:V.emailCode}),l.success("密码修改成功"),Object.assign(V,{newPassword:"",confirmPassword:"",emailCode:""}),T.value.resetFields(),pe()}catch(s){console.error("修改密码失败:",s),l.error("修改密码失败")}finally{Z.value=!1}},qe=s=>{const e=s.type.startsWith("image/"),r=s.size/1024/1024<5;return e?r?!0:(l.error("图片大小不能超过 5MB!"),!1):(l.error("只能上传图片文件!"),!1)},De=s=>{if(console.log("头像上传响应:",s),s&&s.success&&s.data&&s.data.url){const r="https://tukubackend.vtart.cn"+s.data.url+"?t="+Date.now();u.avatar_url=r,O.updateUser({avatar_url:r}),l.success(s.message||"头像上传成功")}else l.error(s.message||"头像上传失败")},ge=s=>{console.error("头像加载失败:",s),console.log("头像URL:",u.avatar_url),l.warning("头像加载失败，将显示默认头像")},We=s=>{if(!s)return"暂无数据";try{const e=new Date(s);return isNaN(e.getTime())?"无效日期":e.toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"日期格式错误"}},Je=async()=>{try{h.value=!0,J.value&&await ce(),await fe(),await me(),l.success("所有设置已保存")}catch(s){console.error("保存设置失败:",s),l.error("保存设置失败")}finally{h.value=!1}},ee=s=>{switch(s){case"profile":return!f.email||!f.email.includes("@")?(l.error("请输入有效的邮箱地址"),!1):f.display_name&&f.display_name.length>50?(l.error("昵称不能超过50个字符"),!1):f.bio&&f.bio.length>200?(l.error("个人简介不能超过200个字符"),!1):!0;case"preferences":return["grid","list"].includes(d.defaultView)?!0:(l.error("默认视图设置无效"),!1);case"notifications":return typeof d.emailNotifications!="boolean"||typeof d.storageWarnings!="boolean"||typeof d.securityAlerts!="boolean"?(l.error("通知设置数据无效"),!1):!0;default:return!1}},Te=()=>{St.confirm("您将跳转到忘记密码页面，通过邮箱验证来重置密码。是否继续？","确认跳转",{confirmButtonText:"继续",cancelButtonText:"取消",type:"info",customClass:"custom-message-box"}).then(()=>{router.push("/forgot-password")}).catch(()=>{})};return Nt(async()=>{console.log("UserCenter组件开始加载...");try{console.log("1. 加载用户基本信息..."),await X(),console.log("2. 加载用户设置..."),await Ce(),console.log("3. 加载本地设置..."),Se(),Ve(),ke(),console.log("4. 初始化通知功能..."),await Ne(),console.log("5. 加载用户统计..."),await ue(),console.log("6. 加载存储详情..."),await de(),v.autoRefresh&&(console.log("7. 启动自动刷新..."),le()),console.log("8. 检查存储警告..."),ne(),console.log("UserCenter组件加载完成!")}catch(s){console.error("UserCenter组件加载失败:",s),l.error("页面加载失败，请刷新重试")}}),Ut(()=>{re(),pe()}),(s,e)=>{const r=Xe,n=He,p=st,Be=at,$e=lt,j=tt,je=it,D=ut,U=et,P=pt,y=mt,M=ft,te=Ke,se=ct,ve=vt,Me=gt,Le=dt,_e=Qe,L=ht,Ze=bt;return E(),z("div",Pt,[t("div",zt,[t("div",Et,[e[21]||(e[21]=t("div",{class:"header-left"},[t("h1",{class:"page-title"},"个人设置"),t("p",{class:"page-subtitle"},"管理您的个人信息和系统设置")],-1)),t("div",xt,[a(n,{type:"primary",onClick:Je,loading:h.value},{default:o(()=>[a(r,null,{default:o(()=>[a(g(Ye))]),_:1}),e[20]||(e[20]=m(" 保存更改 ",-1))]),_:1},8,["loading"])])])]),t("div",At,[a(te,{gutter:24},{default:o(()=>[a(U,{xs:24,sm:24,md:8,lg:6,xl:6},{default:o(()=>[a(j,{class:"user-info-card"},{default:o(()=>[t("div",It,[t("div",Rt,[a(p,{size:100,src:u.avatar_url,class:"user-avatar",onError:ge},{default:o(()=>{var i;return[m(c((i=u.username)==null?void 0:i.charAt(0).toUpperCase()),1)]}),_:1},8,["src"]),t("div",Ft,[a(Be,{action:Pe.value,headers:ze.value,"show-file-list":!1,"before-upload":qe,"on-success":De,"on-error":ge,accept:"image/*"},{default:o(()=>[a(n,{type:"primary",size:"small",circle:""},{default:o(()=>[a(r,null,{default:o(()=>[a(g(ot))]),_:1})]),_:1})]),_:1},8,["action","headers"])])]),t("div",Ot,[t("h3",qt,c(u.username),1),t("p",Dt,[a($e,{type:g(O).isAdmin?"danger":"primary"},{default:o(()=>[m(c(g(O).isAdmin?"管理员":"普通用户"),1)]),_:1},8,["type"])]),t("p",Wt,c(u.email),1)])])]),_:1}),a(j,{class:"storage-card"},{default:o(()=>[t("div",Jt,[e[23]||(e[23]=t("h4",null,"存储使用情况",-1)),a(n,{type:"text",size:"small",onClick:Y,loading:B.value},{default:o(()=>[a(r,null,{default:o(()=>[a(g(rt))]),_:1}),e[22]||(e[22]=m(" 刷新 ",-1))]),_:1},8,["loading"])]),t("div",Tt,[a(je,{percentage:A.value,color:Ue.value,"stroke-width":8},{default:o(({percentage:i})=>[m(c(g(Ct)(i)),1)]),_:1},8,["percentage","color"]),t("div",Bt,[t("span",$t,c(g(N)(u.used_storage)),1),t("span",jt,"/ "+c(g(N)(u.storage_limit)),1)])]),t("div",Mt,[t("div",Lt,[e[24]||(e[24]=t("span",{class:"label"},"图片文件",-1)),t("span",Zt,c(g(N)(b.imageSize)),1)]),t("div",Gt,[e[25]||(e[25]=t("span",{class:"label"},"视频文件",-1)),t("span",Ht,c(g(N)(b.videoSize)),1)]),t("div",Kt,[e[26]||(e[26]=t("span",{class:"label"},"其他文件",-1)),t("span",Qt,c(g(N)(b.otherSize)),1)])]),t("div",Xt,[t("div",Yt,[a(n,{type:"primary",size:"small",onClick:e[0]||(e[0]=i=>q.value=!0),disabled:A.value<80},{default:o(()=>[a(r,null,{default:o(()=>[a(g(nt))]),_:1}),e[27]||(e[27]=m(" 清理存储 ",-1))]),_:1},8,["disabled"])]),t("div",es,[a(n,{type:"text",size:"small",onClick:e[1]||(e[1]=i=>H.value=!0)},{default:o(()=>[...e[28]||(e[28]=[m(" 详细分析 ",-1)])]),_:1})])])]),_:1}),a(j,{class:"quick-settings-card"},{default:o(()=>[e[31]||(e[31]=t("div",{class:"quick-settings-header"},[t("h4",null,"快捷设置")],-1)),t("div",ts,[t("div",ss,[e[29]||(e[29]=t("span",{class:"setting-label"},"自动刷新",-1)),t("div",as,[a(D,{modelValue:v.autoRefresh,"onUpdate:modelValue":e[2]||(e[2]=i=>v.autoRefresh=i),disabled:B.value},null,8,["modelValue","disabled"]),v.autoRefresh?(E(),z("span",os,c(oe.value/1e3)+"秒 ",1)):we("",!0)])]),t("div",ls,[e[30]||(e[30]=t("span",{class:"setting-label"},"通知提醒",-1)),t("div",rs,[a(D,{modelValue:v.notifications,"onUpdate:modelValue":e[3]||(e[3]=i=>v.notifications=i),disabled:!k.value},null,8,["modelValue","disabled"]),k.value?C.value==="denied"?(E(),z("span",ns," 已拒绝 ")):C.value==="granted"?(E(),z("span",us," 已开启 ")):we("",!0):(E(),z("span",is," 不支持 "))])])])]),_:1})]),_:1}),a(U,{xs:24,sm:24,md:16,lg:18,xl:18},{default:o(()=>[a(j,{class:"settings-card"},{default:o(()=>[a(Le,{modelValue:ae.value,"onUpdate:modelValue":e[15]||(e[15]=i=>ae.value=i),class:"settings-tabs"},{default:o(()=>[a(se,{label:"个人信息",name:"profile"},{default:o(()=>[t("div",ds,[e[36]||(e[36]=t("h4",null,"基本信息",-1)),a(M,{ref_key:"profileFormRef",ref:J,model:f,rules:Ee,"label-width":"100px",class:"profile-form"},{default:o(()=>[a(y,{label:"用户名",prop:"username"},{default:o(()=>[a(P,{modelValue:f.username,"onUpdate:modelValue":e[4]||(e[4]=i=>f.username=i),placeholder:"请输入用户名",disabled:!0},null,8,["modelValue"]),e[32]||(e[32]=t("div",{class:"form-hint"},"用户名不可修改",-1))]),_:1}),a(y,{label:"邮箱地址",prop:"email"},{default:o(()=>[a(P,{modelValue:f.email,"onUpdate:modelValue":e[5]||(e[5]=i=>f.email=i),placeholder:"请输入邮箱地址"},null,8,["modelValue"]),e[33]||(e[33]=t("div",{class:"form-hint"},"用于接收系统通知和找回密码",-1))]),_:1}),a(y,{label:"昵称",prop:"display_name"},{default:o(()=>[a(P,{modelValue:f.display_name,"onUpdate:modelValue":e[6]||(e[6]=i=>f.display_name=i),placeholder:"请输入昵称"},null,8,["modelValue"]),e[34]||(e[34]=t("div",{class:"form-hint"},"在其他用户面前显示的名称",-1))]),_:1}),a(y,{label:"个人简介",prop:"bio"},{default:o(()=>[a(P,{modelValue:f.bio,"onUpdate:modelValue":e[7]||(e[7]=i=>f.bio=i),type:"textarea",rows:3,placeholder:"介绍一下自己...",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(y,null,{default:o(()=>[a(n,{type:"primary",onClick:ce,loading:h.value},{default:o(()=>[...e[35]||(e[35]=[m(" 保存个人信息 ",-1)])]),_:1},8,["loading"])]),_:1}),a(y,{label:"注册时间"},{default:o(()=>[a(P,{value:We(u.created_at),disabled:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),t("div",cs,[e[40]||(e[40]=t("h4",null,"账户统计",-1)),a(te,{gutter:16},{default:o(()=>[a(U,{span:8},{default:o(()=>[t("div",fs,[t("div",ms,c($.totalFiles),1),e[37]||(e[37]=t("div",{class:"stat-label"},"文件总数",-1))])]),_:1}),a(U,{span:8},{default:o(()=>[t("div",ps,[t("div",gs,c($.totalFolders),1),e[38]||(e[38]=t("div",{class:"stat-label"},"文件夹数",-1))])]),_:1}),a(U,{span:8},{default:o(()=>[t("div",vs,[t("div",_s,c($.loginCount),1),e[39]||(e[39]=t("div",{class:"stat-label"},"登录次数",-1))])]),_:1})]),_:1})])]),_:1}),a(se,{label:"安全设置",name:"security"},{default:o(()=>[t("div",ys,[e[44]||(e[44]=t("h4",null,"密码安全",-1)),a(M,{ref_key:"passwordFormRef",ref:T,model:V,rules:xe,"label-width":"100px",class:"password-form"},{default:o(()=>[a(y,{label:"新密码",prop:"newPassword"},{default:o(()=>[a(P,{modelValue:V.newPassword,"onUpdate:modelValue":e[8]||(e[8]=i=>V.newPassword=i),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),a(y,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[a(P,{modelValue:V.confirmPassword,"onUpdate:modelValue":e[9]||(e[9]=i=>V.confirmPassword=i),type:"password",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),a(y,{label:"邮箱验证码",prop:"emailCode"},{default:o(()=>[t("div",ws,[a(P,{modelValue:V.emailCode,"onUpdate:modelValue":e[10]||(e[10]=i=>V.emailCode=i),placeholder:"请输入邮箱验证码",maxlength:"6"},null,8,["modelValue"]),a(n,{type:"primary",disabled:x.value>0||!u.email,onClick:Re,loading:G.value,class:"send-code-btn"},{default:o(()=>[m(c(x.value>0?`${x.value}秒后重发`:"发送验证码"),1)]),_:1},8,["disabled","loading"])]),t("div",bs," 验证码将发送到您的邮箱："+c(u.email),1)]),_:1}),a(y,null,{default:o(()=>[t("div",hs,[a(n,{type:"primary",onClick:Oe,loading:Z.value},{default:o(()=>[...e[41]||(e[41]=[m(" 修改密码 ",-1)])]),_:1},8,["loading"]),a(n,{type:"text",class:"forgot-password",onClick:Te},{default:o(()=>[...e[42]||(e[42]=[m(" 忘记密码？ ",-1)])]),_:1})]),e[43]||(e[43]=t("div",{class:"form-hint"}," 如果忘记当前密码，可以通过邮箱验证重置密码 ",-1))]),_:1})]),_:1},8,["model"])])]),_:1}),a(se,{label:"偏好设置",name:"preferences"},{default:o(()=>[t("div",Ss,[e[48]||(e[48]=t("h4",null,"界面设置",-1)),a(M,{"label-width":"100px",class:"preferences-form"},{default:o(()=>[a(y,{label:"默认视图"},{default:o(()=>[a(Me,{modelValue:d.defaultView,"onUpdate:modelValue":e[11]||(e[11]=i=>d.defaultView=i)},{default:o(()=>[a(ve,{label:"grid"},{default:o(()=>[...e[45]||(e[45]=[m("网格视图",-1)])]),_:1}),a(ve,{label:"list"},{default:o(()=>[...e[46]||(e[46]=[m("列表视图",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(y,null,{default:o(()=>[a(n,{type:"primary",onClick:fe,loading:h.value},{default:o(()=>[...e[47]||(e[47]=[m(" 保存界面设置 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),t("div",Vs,[e[50]||(e[50]=t("h4",null,"通知设置",-1)),a(M,{"label-width":"100px",class:"preferences-form"},{default:o(()=>[a(y,{label:"邮件通知"},{default:o(()=>[a(D,{modelValue:d.emailNotifications,"onUpdate:modelValue":e[12]||(e[12]=i=>d.emailNotifications=i)},null,8,["modelValue"])]),_:1}),a(y,{label:"存储警告"},{default:o(()=>[a(D,{modelValue:d.storageWarnings,"onUpdate:modelValue":e[13]||(e[13]=i=>d.storageWarnings=i)},null,8,["modelValue"])]),_:1}),a(y,{label:"安全提醒"},{default:o(()=>[a(D,{modelValue:d.securityAlerts,"onUpdate:modelValue":e[14]||(e[14]=i=>d.securityAlerts=i)},null,8,["modelValue"])]),_:1}),a(y,null,{default:o(()=>[a(n,{type:"primary",onClick:me,loading:h.value},{default:o(()=>[...e[49]||(e[49]=[m(" 保存通知设置 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),a(_e,{modelValue:H.value,"onUpdate:modelValue":e[16]||(e[16]=i=>H.value=i),title:"存储详细分析",width:"600px"},{default:o(()=>[t("div",Cs,[t("div",ks,[e[57]||(e[57]=t("h4",null,"文件类型分布",-1)),a(te,{gutter:16},{default:o(()=>[a(U,{span:8},{default:o(()=>[t("div",Ns,[e[52]||(e[52]=t("div",{class:"type-icon image"},"📷",-1)),t("div",Us,[e[51]||(e[51]=t("div",{class:"type-name"},"图片",-1)),t("div",Ps,c(g(N)(b.imageSize)),1),t("div",zs,c(b.imageCount)+" 个文件",1)])])]),_:1}),a(U,{span:8},{default:o(()=>[t("div",Es,[e[54]||(e[54]=t("div",{class:"type-icon video"},"🎥",-1)),t("div",xs,[e[53]||(e[53]=t("div",{class:"type-name"},"视频",-1)),t("div",As,c(g(N)(b.videoSize)),1),t("div",Is,c(b.videoCount)+" 个文件",1)])])]),_:1}),a(U,{span:8},{default:o(()=>[t("div",Rs,[e[56]||(e[56]=t("div",{class:"type-icon other"},"📄",-1)),t("div",Fs,[e[55]||(e[55]=t("div",{class:"type-name"},"其他",-1)),t("div",Os,c(g(N)(b.otherSize)),1),t("div",qs,c(b.otherCount)+" 个文件",1)])])]),_:1})]),_:1})]),t("div",Ds,[e[61]||(e[61]=t("h4",null,"存储建议",-1)),t("div",Ws,[A.value>=90?(E(),z("div",Js,[a(r,null,{default:o(()=>[a(g(_t))]),_:1}),e[58]||(e[58]=t("span",null,"存储空间严重不足，建议立即清理文件",-1))])):A.value>=80?(E(),z("div",Ts,[a(r,null,{default:o(()=>[a(g(yt))]),_:1}),e[59]||(e[59]=t("span",null,"存储空间使用率较高，建议适当清理",-1))])):(E(),z("div",Bs,[a(r,null,{default:o(()=>[a(g(wt))]),_:1}),e[60]||(e[60]=t("span",null,"存储空间使用正常",-1))]))])])])]),_:1},8,["modelValue"]),a(_e,{modelValue:q.value,"onUpdate:modelValue":e[19]||(e[19]=i=>q.value=i),title:"存储清理",width:"500px"},{footer:o(()=>[a(n,{onClick:e[18]||(e[18]=i=>q.value=!1)},{default:o(()=>[...e[68]||(e[68]=[m("取消",-1)])]),_:1}),a(n,{type:"primary",onClick:Ae,loading:K.value},{default:o(()=>[...e[69]||(e[69]=[m(" 开始清理 ",-1)])]),_:1},8,["loading"])]),default:o(()=>[t("div",$s,[e[67]||(e[67]=t("p",null,"选择要清理的内容：",-1)),a(Ze,{modelValue:w.value,"onUpdate:modelValue":e[17]||(e[17]=i=>w.value=i)},{default:o(()=>[a(L,{label:"duplicates"},{default:o(()=>[...e[62]||(e[62]=[m("重复文件",-1)])]),_:1}),a(L,{label:"temp"},{default:o(()=>[...e[63]||(e[63]=[m("临时文件",-1)])]),_:1}),a(L,{label:"large"},{default:o(()=>[...e[64]||(e[64]=[m("大文件（>10MB）",-1)])]),_:1}),a(L,{label:"old"},{default:o(()=>[...e[65]||(e[65]=[m("30天前的文件",-1)])]),_:1})]),_:1},8,["modelValue"]),t("div",js,[t("p",null,[e[66]||(e[66]=m("预计可释放空间：",-1)),t("strong",null,c(g(N)(Ie.value)),1)])])])]),_:1},8,["modelValue"])])}}}),ca=Ge(Ms,[["__scopeId","data-v-e02ab582"]]);export{ca as default};
