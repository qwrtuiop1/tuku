import{_ as ue}from"./_plugin-vue_export-helper-BwE83l92.js";/* empty css               *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                  *//* empty css                       *//* empty css                  *//* empty css                    *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                *//* empty css                     */import{c as me,aq as de,b as pe,C as fe,ar as ge,y as be,F as ye,M as ve,O as _e,q as xe,l as Ve,aL as we,aM as Se,d as ke,e as Ee,f as Fe,w as M,aB as Le,aC as Ue,h as Ne,aA as ce,aH as Ie,aI as Pe,aN as Te,al as Ce,E as y}from"./element-CHj0RLGm.js";import{a as I}from"./index-JAZUU9Ah.js";import{y as ze,r as L,l as R,j as Me,z as P,B as o,R as l,J as t,A as _,O as d,u as x,L as V,I as A}from"./vendor-BcB6VvZI.js";const Re={class:"settings-page"},Ae={class:"page-header"},De={class:"header-content"},qe={class:"header-actions"},je={class:"settings-content"},Be={key:0,class:"settings-section"},Ge={key:1,class:"settings-section"},He={key:2,class:"settings-section"},We={key:3,class:"settings-section"},Je={key:4,class:"settings-section"},Oe=ze({__name:"SettingsPage",setup(Ke){const H=L(!1),f=L(!1),k=L("general"),W=L(),J=L(),O=L(),Z=L(),$=L(),w=R({systemName:"",systemDescription:""}),u=R({maxFileSize:100,maxUploadFiles:10,allowedImageTypes:["jpg","jpeg","png","gif","webp"],allowedVideoTypes:["mp4","webm","mov"],thumbnailSize:300}),r=R({minPasswordLength:6,enableLoginLock:!0,maxLoginAttempts:5,lockoutDuration:15,sessionTimeout:120}),i=R({enableEmailNotification:!1,smtpHost:"",smtpPort:587,senderEmail:"",enableSystemNotification:!0}),p=R({themeMode:"light",primaryColor:"#409EFF",sidebarWidth:240,enableAnimation:!0}),h={systemName:[{required:!0,message:"请输入系统名称",trigger:"blur"},{max:50,message:"系统名称长度不能超过 50 个字符",trigger:"blur"}],systemDescription:[{max:200,message:"系统描述长度不能超过 200 个字符",trigger:"blur"}]},ee={maxFileSize:[{required:!0,message:"请输入最大文件大小",trigger:"blur"}],maxUploadFiles:[{required:!0,message:"请输入最大上传文件数",trigger:"blur"}],thumbnailSize:[{required:!0,message:"请输入缩略图尺寸",trigger:"blur"}]},le={minPasswordLength:[{required:!0,message:"请输入密码最小长度",trigger:"blur"}],maxLoginAttempts:[{required:!0,message:"请输入最大失败次数",trigger:"blur"}],lockoutDuration:[{required:!0,message:"请输入锁定时间",trigger:"blur"}],sessionTimeout:[{required:!0,message:"请输入会话超时时间",trigger:"blur"}]},te=n=>{k.value=n},oe=async()=>{H.value=!0;try{await Q(),y.success("设置已刷新")}catch(n){console.error("刷新设置失败:",n),y.error("刷新设置失败")}finally{H.value=!1}},Q=async()=>{var n,e,g,S,E,D,T,C,U,a,F,v,b,z,N,c,q,j,B,G,s,X,Y;try{const m=(await I.get("/admin/settings")).data.settings||{};w.systemName=((n=m.system_name)==null?void 0:n.value)||"图库系统",w.systemDescription=((e=m.system_description)==null?void 0:e.value)||"",u.maxFileSize=parseInt((g=m.max_file_size)==null?void 0:g.value)||100,u.maxUploadFiles=parseInt((S=m.max_upload_files)==null?void 0:S.value)||10,u.allowedImageTypes=((D=(E=m.allowed_image_types)==null?void 0:E.value)==null?void 0:D.split(","))||["jpg","jpeg","png","gif","webp"],u.allowedVideoTypes=((C=(T=m.allowed_video_types)==null?void 0:T.value)==null?void 0:C.split(","))||["mp4","webm","mov"],u.thumbnailSize=parseInt((U=m.thumbnail_size)==null?void 0:U.value)||300,r.minPasswordLength=parseInt((a=m.min_password_length)==null?void 0:a.value)||6,r.enableLoginLock=((F=m.enable_login_lock)==null?void 0:F.value)==="true",r.maxLoginAttempts=parseInt((v=m.max_login_attempts)==null?void 0:v.value)||5,r.lockoutDuration=parseInt((b=m.lockout_duration)==null?void 0:b.value)||15,r.sessionTimeout=parseInt((z=m.session_timeout)==null?void 0:z.value)||120,i.enableEmailNotification=((N=m.enable_email_notification)==null?void 0:N.value)==="true",i.smtpHost=((c=m.smtp_host)==null?void 0:c.value)||"",i.smtpPort=parseInt((q=m.smtp_port)==null?void 0:q.value)||587,i.senderEmail=((j=m.sender_email)==null?void 0:j.value)||"",i.enableSystemNotification=((B=m.enable_system_notification)==null?void 0:B.value)==="true",p.themeMode=((G=m.theme_mode)==null?void 0:G.value)||"light",p.primaryColor=((s=m.primary_color)==null?void 0:s.value)||"#409EFF",p.sidebarWidth=parseInt((X=m.sidebar_width)==null?void 0:X.value)||240,p.enableAnimation=((Y=m.enable_animation)==null?void 0:Y.value)==="true"}catch(K){throw console.error("获取设置失败:",K),K}},se=async()=>{if(W.value)try{await W.value.validate(),f.value=!0;const n={system_name:w.systemName,system_description:w.systemDescription};await I.put("/admin/settings",{settings:n}),y.success("常规设置保存成功")}catch(n){console.error("保存常规设置失败:",n),y.error("保存常规设置失败")}finally{f.value=!1}},ae=async()=>{if(J.value)try{await J.value.validate(),f.value=!0;const n={max_file_size:u.maxFileSize.toString(),max_upload_files:u.maxUploadFiles.toString(),allowed_image_types:u.allowedImageTypes.join(","),allowed_video_types:u.allowedVideoTypes.join(","),thumbnail_size:u.thumbnailSize.toString()};await I.put("/admin/settings",{settings:n}),y.success("存储设置保存成功")}catch(n){console.error("保存存储设置失败:",n),y.error("保存存储设置失败")}finally{f.value=!1}},ne=async()=>{if(O.value)try{await O.value.validate(),f.value=!0;const n={min_password_length:r.minPasswordLength.toString(),enable_login_lock:r.enableLoginLock.toString(),max_login_attempts:r.maxLoginAttempts.toString(),lockout_duration:r.lockoutDuration.toString(),session_timeout:r.sessionTimeout.toString()};await I.put("/admin/settings",{settings:n}),y.success("安全设置保存成功")}catch(n){console.error("保存安全设置失败:",n),y.error("保存安全设置失败")}finally{f.value=!1}},ie=async()=>{try{f.value=!0;const n={enable_email_notification:i.enableEmailNotification.toString(),smtp_host:i.smtpHost,smtp_port:i.smtpPort.toString(),sender_email:i.senderEmail,enable_system_notification:i.enableSystemNotification.toString()};await I.put("/admin/settings",{settings:n}),y.success("通知设置保存成功")}catch(n){console.error("保存通知设置失败:",n),y.error("保存通知设置失败")}finally{f.value=!1}},re=async()=>{try{f.value=!0;const n={theme_mode:p.themeMode,primary_color:p.primaryColor,sidebar_width:p.sidebarWidth.toString(),enable_animation:p.enableAnimation.toString()};await I.put("/admin/settings",{settings:n}),y.success("外观设置保存成功")}catch(n){console.error("保存外观设置失败:",n),y.error("保存外观设置失败")}finally{f.value=!1}};return Me(()=>{Q()}),(n,e)=>{const g=pe,S=me,E=ve,D=ye,T=be,C=ge,U=Fe,a=Ee,F=ke,v=Le,b=Ne,z=Ue,N=ce,c=Pe,q=Ie,j=Te,B=Ce,G=de;return _(),P("div",Re,[o("div",Ae,[o("div",De,[e[23]||(e[23]=o("div",{class:"header-left"},[o("h1",{class:"page-title"},"系统设置"),o("p",{class:"page-subtitle"},"配置系统参数和功能选项")],-1)),o("div",qe,[l(S,{onClick:oe,loading:H.value},{default:t(()=>[l(g,null,{default:t(()=>[l(x(fe))]),_:1}),e[22]||(e[22]=d(" 刷新 ",-1))]),_:1},8,["loading"])])])]),o("div",je,[l(G,{gutter:24},{default:t(()=>[l(C,{xs:24,sm:6,md:6,lg:6,xl:6},{default:t(()=>[l(T,{class:"settings-nav-card"},{default:t(()=>[l(D,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=s=>k.value=s),class:"settings-menu",onSelect:te},{default:t(()=>[l(E,{index:"general"},{default:t(()=>[l(g,null,{default:t(()=>[l(x(_e))]),_:1}),e[24]||(e[24]=o("span",null,"常规设置",-1))]),_:1}),l(E,{index:"storage"},{default:t(()=>[l(g,null,{default:t(()=>[l(x(xe))]),_:1}),e[25]||(e[25]=o("span",null,"存储设置",-1))]),_:1}),l(E,{index:"security"},{default:t(()=>[l(g,null,{default:t(()=>[l(x(Ve))]),_:1}),e[26]||(e[26]=o("span",null,"安全设置",-1))]),_:1}),l(E,{index:"notification"},{default:t(()=>[l(g,null,{default:t(()=>[l(x(we))]),_:1}),e[27]||(e[27]=o("span",null,"通知设置",-1))]),_:1}),l(E,{index:"appearance"},{default:t(()=>[l(g,null,{default:t(()=>[l(x(Se))]),_:1}),e[28]||(e[28]=o("span",null,"外观设置",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(C,{xs:24,sm:18,md:18,lg:18,xl:18},{default:t(()=>[l(T,{class:"settings-panel-card"},{default:t(()=>[k.value==="general"?(_(),P("div",Be,[e[30]||(e[30]=o("div",{class:"section-header"},[o("h3",null,"常规设置"),o("p",null,"配置系统基本参数")],-1)),l(F,{model:w,rules:h,ref_key:"generalFormRef",ref:W,"label-width":"120px",class:"settings-form"},{default:t(()=>[l(a,{label:"系统名称",prop:"systemName"},{default:t(()=>[l(U,{modelValue:w.systemName,"onUpdate:modelValue":e[1]||(e[1]=s=>w.systemName=s),placeholder:"请输入系统名称"},null,8,["modelValue"])]),_:1}),l(a,{label:"系统描述",prop:"systemDescription"},{default:t(()=>[l(U,{modelValue:w.systemDescription,"onUpdate:modelValue":e[2]||(e[2]=s=>w.systemDescription=s),type:"textarea",rows:3,placeholder:"请输入系统描述"},null,8,["modelValue"])]),_:1}),l(a,null,{default:t(()=>[l(S,{type:"primary",onClick:se,loading:f.value},{default:t(()=>[l(g,null,{default:t(()=>[l(x(M))]),_:1}),e[29]||(e[29]=d(" 保存设置 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):V("",!0),k.value==="storage"?(_(),P("div",Ge,[e[51]||(e[51]=o("div",{class:"section-header"},[o("h3",null,"存储设置"),o("p",null,"配置文件存储相关参数")],-1)),l(F,{model:u,rules:ee,ref_key:"storageFormRef",ref:J,"label-width":"120px",class:"settings-form"},{default:t(()=>[l(a,{label:"最大文件大小",prop:"maxFileSize"},{default:t(()=>[l(v,{modelValue:u.maxFileSize,"onUpdate:modelValue":e[3]||(e[3]=s=>u.maxFileSize=s),min:1,max:1e3,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[31]||(e[31]=o("span",{class:"form-unit"},"MB",-1)),e[32]||(e[32]=o("span",{class:"form-description"},"单个文件上传的最大大小限制",-1))]),_:1}),l(a,{label:"单次上传文件数",prop:"maxUploadFiles"},{default:t(()=>[l(v,{modelValue:u.maxUploadFiles,"onUpdate:modelValue":e[4]||(e[4]=s=>u.maxUploadFiles=s),min:1,max:50,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[33]||(e[33]=o("span",{class:"form-unit"},"个",-1)),e[34]||(e[34]=o("span",{class:"form-description"},"单次最多可以上传的文件数量",-1))]),_:1}),l(a,{label:"允许的图片类型"},{default:t(()=>[l(z,{modelValue:u.allowedImageTypes,"onUpdate:modelValue":e[5]||(e[5]=s=>u.allowedImageTypes=s)},{default:t(()=>[l(b,{label:"jpg"},{default:t(()=>[...e[35]||(e[35]=[d("JPG",-1)])]),_:1}),l(b,{label:"jpeg"},{default:t(()=>[...e[36]||(e[36]=[d("JPEG",-1)])]),_:1}),l(b,{label:"png"},{default:t(()=>[...e[37]||(e[37]=[d("PNG",-1)])]),_:1}),l(b,{label:"gif"},{default:t(()=>[...e[38]||(e[38]=[d("GIF",-1)])]),_:1}),l(b,{label:"webp"},{default:t(()=>[...e[39]||(e[39]=[d("WebP",-1)])]),_:1}),l(b,{label:"svg"},{default:t(()=>[...e[40]||(e[40]=[d("SVG",-1)])]),_:1})]),_:1},8,["modelValue"]),e[41]||(e[41]=o("div",{class:"form-description"},"选择允许上传的图片格式",-1))]),_:1}),l(a,{label:"允许的视频类型"},{default:t(()=>[l(z,{modelValue:u.allowedVideoTypes,"onUpdate:modelValue":e[6]||(e[6]=s=>u.allowedVideoTypes=s)},{default:t(()=>[l(b,{label:"mp4"},{default:t(()=>[...e[42]||(e[42]=[d("MP4",-1)])]),_:1}),l(b,{label:"webm"},{default:t(()=>[...e[43]||(e[43]=[d("WebM",-1)])]),_:1}),l(b,{label:"mov"},{default:t(()=>[...e[44]||(e[44]=[d("MOV",-1)])]),_:1}),l(b,{label:"avi"},{default:t(()=>[...e[45]||(e[45]=[d("AVI",-1)])]),_:1}),l(b,{label:"mkv"},{default:t(()=>[...e[46]||(e[46]=[d("MKV",-1)])]),_:1})]),_:1},8,["modelValue"]),e[47]||(e[47]=o("div",{class:"form-description"},"选择允许上传的视频格式",-1))]),_:1}),l(a,{label:"缩略图尺寸",prop:"thumbnailSize"},{default:t(()=>[l(v,{modelValue:u.thumbnailSize,"onUpdate:modelValue":e[7]||(e[7]=s=>u.thumbnailSize=s),min:100,max:1e3,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[48]||(e[48]=o("span",{class:"form-unit"},"px",-1)),e[49]||(e[49]=o("span",{class:"form-description"},"生成缩略图的尺寸",-1))]),_:1}),l(a,null,{default:t(()=>[l(S,{type:"primary",onClick:ae,loading:f.value},{default:t(()=>[l(g,null,{default:t(()=>[l(x(M))]),_:1}),e[50]||(e[50]=d(" 保存设置 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):V("",!0),k.value==="security"?(_(),P("div",He,[e[62]||(e[62]=o("div",{class:"section-header"},[o("h3",null,"安全设置"),o("p",null,"配置系统安全相关参数")],-1)),l(F,{model:r,rules:le,ref_key:"securityFormRef",ref:O,"label-width":"120px",class:"settings-form"},{default:t(()=>[l(a,{label:"密码最小长度",prop:"minPasswordLength"},{default:t(()=>[l(v,{modelValue:r.minPasswordLength,"onUpdate:modelValue":e[8]||(e[8]=s=>r.minPasswordLength=s),min:6,max:20,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[52]||(e[52]=o("span",{class:"form-unit"},"位",-1)),e[53]||(e[53]=o("span",{class:"form-description"},"用户密码的最小长度要求",-1))]),_:1}),l(a,{label:"登录失败锁定"},{default:t(()=>[l(N,{modelValue:r.enableLoginLock,"onUpdate:modelValue":e[9]||(e[9]=s=>r.enableLoginLock=s),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"]),e[54]||(e[54]=o("span",{class:"form-description"},"登录失败次数过多时锁定账户",-1))]),_:1}),r.enableLoginLock?(_(),A(a,{key:0,label:"最大失败次数",prop:"maxLoginAttempts"},{default:t(()=>[l(v,{modelValue:r.maxLoginAttempts,"onUpdate:modelValue":e[10]||(e[10]=s=>r.maxLoginAttempts=s),min:3,max:10,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[55]||(e[55]=o("span",{class:"form-unit"},"次",-1)),e[56]||(e[56]=o("span",{class:"form-description"},"达到此次数后锁定账户",-1))]),_:1})):V("",!0),r.enableLoginLock?(_(),A(a,{key:1,label:"锁定时间",prop:"lockoutDuration"},{default:t(()=>[l(v,{modelValue:r.lockoutDuration,"onUpdate:modelValue":e[11]||(e[11]=s=>r.lockoutDuration=s),min:5,max:60,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[57]||(e[57]=o("span",{class:"form-unit"},"分钟",-1)),e[58]||(e[58]=o("span",{class:"form-description"},"账户锁定的持续时间",-1))]),_:1})):V("",!0),l(a,{label:"会话超时时间",prop:"sessionTimeout"},{default:t(()=>[l(v,{modelValue:r.sessionTimeout,"onUpdate:modelValue":e[12]||(e[12]=s=>r.sessionTimeout=s),min:30,max:1440,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[59]||(e[59]=o("span",{class:"form-unit"},"分钟",-1)),e[60]||(e[60]=o("span",{class:"form-description"},"用户会话的超时时间",-1))]),_:1}),l(a,null,{default:t(()=>[l(S,{type:"primary",onClick:ne,loading:f.value},{default:t(()=>[l(g,null,{default:t(()=>[l(x(M))]),_:1}),e[61]||(e[61]=d(" 保存设置 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):V("",!0),k.value==="notification"?(_(),P("div",We,[e[66]||(e[66]=o("div",{class:"section-header"},[o("h3",null,"通知设置"),o("p",null,"配置系统通知相关参数")],-1)),l(F,{model:i,ref_key:"notificationFormRef",ref:Z,"label-width":"120px",class:"settings-form"},{default:t(()=>[l(a,{label:"邮件通知"},{default:t(()=>[l(N,{modelValue:i.enableEmailNotification,"onUpdate:modelValue":e[13]||(e[13]=s=>i.enableEmailNotification=s),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"]),e[63]||(e[63]=o("span",{class:"form-description"},"是否启用邮件通知功能",-1))]),_:1}),i.enableEmailNotification?(_(),A(a,{key:0,label:"SMTP服务器",prop:"smtpHost"},{default:t(()=>[l(U,{modelValue:i.smtpHost,"onUpdate:modelValue":e[14]||(e[14]=s=>i.smtpHost=s),placeholder:"请输入SMTP服务器地址"},null,8,["modelValue"])]),_:1})):V("",!0),i.enableEmailNotification?(_(),A(a,{key:1,label:"SMTP端口",prop:"smtpPort"},{default:t(()=>[l(v,{modelValue:i.smtpPort,"onUpdate:modelValue":e[15]||(e[15]=s=>i.smtpPort=s),min:1,max:65535,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"])]),_:1})):V("",!0),i.enableEmailNotification?(_(),A(a,{key:2,label:"发件人邮箱",prop:"senderEmail"},{default:t(()=>[l(U,{modelValue:i.senderEmail,"onUpdate:modelValue":e[16]||(e[16]=s=>i.senderEmail=s),placeholder:"请输入发件人邮箱"},null,8,["modelValue"])]),_:1})):V("",!0),l(a,{label:"系统通知"},{default:t(()=>[l(N,{modelValue:i.enableSystemNotification,"onUpdate:modelValue":e[17]||(e[17]=s=>i.enableSystemNotification=s),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"]),e[64]||(e[64]=o("span",{class:"form-description"},"是否在系统内显示通知",-1))]),_:1}),l(a,null,{default:t(()=>[l(S,{type:"primary",onClick:ie,loading:f.value},{default:t(()=>[l(g,null,{default:t(()=>[l(x(M))]),_:1}),e[65]||(e[65]=d(" 保存设置 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):V("",!0),k.value==="appearance"?(_(),P("div",Je,[e[74]||(e[74]=o("div",{class:"section-header"},[o("h3",null,"外观设置"),o("p",null,"配置系统界面外观")],-1)),l(F,{model:p,ref_key:"appearanceFormRef",ref:$,"label-width":"120px",class:"settings-form"},{default:t(()=>[l(a,{label:"主题模式"},{default:t(()=>[l(q,{modelValue:p.themeMode,"onUpdate:modelValue":e[18]||(e[18]=s=>p.themeMode=s)},{default:t(()=>[l(c,{label:"light"},{default:t(()=>[...e[67]||(e[67]=[d("浅色模式",-1)])]),_:1}),l(c,{label:"dark"},{default:t(()=>[...e[68]||(e[68]=[d("深色模式",-1)])]),_:1}),l(c,{label:"auto"},{default:t(()=>[...e[69]||(e[69]=[d("跟随系统",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(a,{label:"主色调"},{default:t(()=>[l(j,{modelValue:p.primaryColor,"onUpdate:modelValue":e[19]||(e[19]=s=>p.primaryColor=s)},null,8,["modelValue"]),e[70]||(e[70]=o("span",{class:"form-description"},"系统的主色调",-1))]),_:1}),l(a,{label:"侧边栏宽度"},{default:t(()=>[l(B,{modelValue:p.sidebarWidth,"onUpdate:modelValue":e[20]||(e[20]=s=>p.sidebarWidth=s),min:200,max:300,"show-input":"",style:{width:"300px"}},null,8,["modelValue"]),e[71]||(e[71]=o("span",{class:"form-description"},"侧边栏的宽度",-1))]),_:1}),l(a,{label:"页面动画"},{default:t(()=>[l(N,{modelValue:p.enableAnimation,"onUpdate:modelValue":e[21]||(e[21]=s=>p.enableAnimation=s),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"]),e[72]||(e[72]=o("span",{class:"form-description"},"是否启用页面切换动画",-1))]),_:1}),l(a,null,{default:t(()=>[l(S,{type:"primary",onClick:re,loading:f.value},{default:t(()=>[l(g,null,{default:t(()=>[l(x(M))]),_:1}),e[73]||(e[73]=d(" 保存设置 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):V("",!0)]),_:1})]),_:1})]),_:1})])])}}}),ml=ue(Oe,[["__scopeId","data-v-6233b0da"]]);export{ml as default};
